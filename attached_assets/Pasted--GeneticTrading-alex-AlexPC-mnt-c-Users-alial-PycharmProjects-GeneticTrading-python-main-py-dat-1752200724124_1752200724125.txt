(GeneticTrading) alex@AlexPC:/mnt/c/Users/alial/PycharmProjects/GeneticTrading$ python main.py --data-folder ./data_txt --max-rows 50000 --adaptive-iterations 3 --log-level INFO --training-mode adaptive
2025-07-10 19:06:48.033632: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-07-10 19:06:48.041634: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1752199608.051844  537073 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1752199608.055294  537073 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-07-10 19:06:48.065965: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:root:Distributed training not available (Distributed environment variables not set), running in single-process mode
WARNING:root:To use all 4 GPUs, run with: torchrun --nproc_per_node=4 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=12355 main.py
2025-07-10 19:06:49 [INFO    ] 🔸 SESSION        : ================================================================================
2025-07-10 19:06:49 [INFO    ] 🔸 SESSION        : 🎯 Revolutionary NQ Futures Trading System
2025-07-10 19:06:49 [INFO    ] 🔸 SESSION        : 📊 Session started at 2025-07-10 19:06:49.120845
2025-07-10 19:06:49 [INFO    ] 🔸 SESSION        : 💻 Process rank: 0
2025-07-10 19:06:49 [INFO    ] 🔸 SESSION        : 📁 Log file: logs/trading_system_rank_0.log
2025-07-10 19:06:49 [INFO    ] 🔸 SESSION        : ================================================================================
2025-07-10 19:06:49 [INFO    ] 🔸 MAIN           : 🚀 Revolutionary Trading System Started
2025-07-10 19:06:49 [INFO    ] 🔸 MAIN           : NCCL_TIMEOUT = 1800000 ms
2025-07-10 19:06:49 [INFO    ] 🔸 MAIN           : Using 100.0% of available data
2025-07-10 19:06:49 [INFO    ] 🔸 MAIN           : Models directory: ./models
2025-07-10 19:06:49 [INFO    ] 🔸 MAIN           : Training mode: adaptive
2025-07-10 19:06:49 [INFO    ] 🔸 MAIN           : Device configuration: cuda:0
2025-07-10 19:06:49 [INFO    ] 🔸 MAIN           : World size: 1, Local rank: 0
2025-07-10 19:06:49 [INFO    ] 🔸 root           : Rank 0/1 starting on cuda:0 (has_cudf=True)
2025-07-10 19:06:49 [INFO    ] 🔸 root           : Data loading parameters: max_rows=50000, data_percentage=1.0
2025-07-10 19:06:49 [INFO    ] 🔸 root           : Parquet cache found; skipping preprocessing.
2025-07-10 19:06:49 [INFO    ] 🔸 root           : Total data: 40000 train, 10000 test rows
2025-07-10 19:06:49 [INFO    ] 🔸 numba.cuda.cudadrv.driver: init
2025-07-10 19:06:50 [INFO    ] 🔸 VISUALIZATION  : 🎨 Visualization system initialized on port 5000
2025-07-10 19:06:50 [INFO    ] 🔸 VISUALIZATION  : 🌐 Dashboard server started at http://0.0.0.0:5000
2025-07-10 19:06:50 [INFO    ] 🔸 VISUALIZATION  : 🔗 View dashboard at: http://0.0.0.0:5000/trading_dashboard.html
2025-07-10 19:06:50 [INFO    ] 🔸 root           : 🌐 Real-time dashboard available at http://0.0.0.0:5000/trading_dashboard.html
2025-07-10 19:06:50 [INFO    ] 🔸 email_notifications: Email notifications configured for ali.aloraibi@outlook.com
2025-07-10 19:06:50 [INFO    ] 🔸 email_notifications: Notifications will be sent every 6 hours
2025-07-10 19:06:50 [INFO    ] 🔸 email_notifications: No training metrics available for progress update
2025-07-10 19:06:50 [INFO    ] 🔸 email_notifications: Training monitoring started
2025-07-10 19:06:50 [INFO    ] 🔸 root           : 📧 Email notifications enabled
2025-07-10 19:06:50 [INFO    ] 🔸 adaptive_trainer: Removed old TensorBoard run: ./runs/ga_experiment
2025-07-10 19:06:50 [INFO    ] 🔸 adaptive_trainer: Starting adaptive training
2025-07-10 19:06:50 [INFO    ] 🔸 adaptive_trainer:
=== Adaptive Training Iteration 1/10 ===
2025-07-10 19:07:09 [INFO    ] 🔸 adaptive_trainer: Evaluation results: 9946 profits, total=0.0000
2025-07-10 19:07:09 [INFO    ] 🔸 adaptive_trainer: Metrics: CAGR=0.0000, Sharpe=-5.0000, MDD=0.0000
2025-07-10 19:07:09 [INFO    ] 🔸 adaptive_trainer: Current performance: -0.2500 (best: -0.2500)
2025-07-10 19:07:09 [INFO    ] 🔸 adaptive_trainer: Stagnation: 0, Poor performance: 0
2025-07-10 19:07:09 [INFO    ] 🔸 adaptive_trainer: Method: GA, Entropy: 1.9459
2025-07-10 19:07:09 [INFO    ] 🔸 adaptive_trainer: Switching to PPO due to: ga_solution_refinement
2025-07-10 19:07:09 [INFO    ] 🔸 adaptive_trainer: Switching from GA to PPO
2025-07-10 19:07:09 [INFO    ] 🔸 adaptive_trainer: Starting PPO phase: 150 updates
2025-07-10 19:07:09 [INFO    ] 🔸 policy_gradient_methods: No model file at models/ppo_models/adaptive_ppo_model.pth, starting from scratch
Removed old TensorBoard run: ./runs/ppo_rank_0
2025-07-10 19:07:24 [INFO    ] 🔸 adaptive_trainer: Evaluation results: 6537 profits, total=0.0000
2025-07-10 19:07:24 [INFO    ] 🔸 adaptive_trainer: Metrics: CAGR=0.0000, Sharpe=0.0000, MDD=0.0000
^CTraceback (most recent call last):                                                                                                                                                                                                
  File "/mnt/c/Users/alial/PycharmProjects/GeneticTrading/main.py", line 662, in <module>
    except Exception as e:
^^
  File "/mnt/c/Users/alial/PycharmProjects/GeneticTrading/main.py", line 591, in main


  File "/mnt/c/Users/alial/PycharmProjects/GeneticTrading/adaptive_trainer.py", line 644, in adaptive_train
    self.run_ppo_phase(total_updates=updates)
  File "/mnt/c/Users/alial/PycharmProjects/GeneticTrading/adaptive_trainer.py", line 473, in run_ppo_phase
    reward = self.ppo_trainer.train_step()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/alial/PycharmProjects/GeneticTrading/policy_gradient_methods.py", line 599, in train_step
    if param.grad is not None and not torch.all(torch.isfinite(param.grad)):
                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
^C
(GeneticTrading) alex@AlexPC:/mnt/c/Users/alial/PycharmProjects/GeneticTrading$ ^C
(GeneticTrading) alex@AlexPC:/mnt/c/Users/alial/PycharmProjects/GeneticTrading$ ^C
(GeneticTrading) alex@AlexPC:/mnt/c/Users/alial/PycharmProjects/GeneticTrading$ ^C
(GeneticTrading) alex@AlexPC:/mnt/c/Users/alial/PycharmProjects/GeneticTrading$ ^C
(GeneticTrading) alex@AlexPC:/mnt/c/Users/alial/PycharmProjects/GeneticTrading$ python main.py --data-folder ./data_txt --max-rows 50000 --adaptive-iterations 3 --log-level INFO --training-mode adaptive
Traceback (most recent call last):
  File "/mnt/c/Users/alial/PycharmProjects/GeneticTrading/main.py", line 75, in <module>
    from data_preprocessing import create_environment_data
  File "/mnt/c/Users/alial/PycharmProjects/GeneticTrading/data_preprocessing.py", line 254
    file_df = file_df.dropna(subset=["date_time"])
                                                  ^
IndentationError: unindent does not match any outer indentation level
(GeneticTrading) alex@AlexPC:/mnt/c/Users/alial/PycharmProjects/GeneticTrading$ python main.py --data-folder ./data_txt --max-rows 50000 --adaptive-iterations 3 --log-level INFO --training-mode adaptive
2025-07-10 19:24:16.817000: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-07-10 19:24:16.883809: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1752200656.897123  540081 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1752200656.902839  540081 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-07-10 19:24:16.977639: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:root:Distributed training not available (Distributed environment variables not set), running in single-process mode
WARNING:root:To use all 4 GPUs, run with: torchrun --nproc_per_node=4 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=12355 main.py
2025-07-10 19:24:18 [INFO    ] 🔸 SESSION        : ================================================================================
2025-07-10 19:24:18 [INFO    ] 🔸 SESSION        : 🎯 Revolutionary NQ Futures Trading System
2025-07-10 19:24:18 [INFO    ] 🔸 SESSION        : 📊 Session started at 2025-07-10 19:24:18.701615
2025-07-10 19:24:18 [INFO    ] 🔸 SESSION        : 💻 Process rank: 0
2025-07-10 19:24:18 [INFO    ] 🔸 SESSION        : 📁 Log file: logs/trading_system_rank_0.log
2025-07-10 19:24:18 [INFO    ] 🔸 SESSION        : ================================================================================
2025-07-10 19:24:18 [INFO    ] 🔸 MAIN           : 🚀 Revolutionary Trading System Started
2025-07-10 19:24:18 [INFO    ] 🔸 MAIN           : NCCL_TIMEOUT = 1800000 ms
2025-07-10 19:24:18 [INFO    ] 🔸 MAIN           : Using 100.0% of available data
2025-07-10 19:24:18 [INFO    ] 🔸 MAIN           : Models directory: ./models
2025-07-10 19:24:18 [INFO    ] 🔸 MAIN           : Training mode: adaptive
2025-07-10 19:24:18 [INFO    ] 🔸 MAIN           : Device configuration: cuda:0
2025-07-10 19:24:18 [INFO    ] 🔸 MAIN           : World size: 1, Local rank: 0
2025-07-10 19:24:18 [INFO    ] 🔸 root           : Rank 0/1 starting on cuda:0 (has_cudf=True)
2025-07-10 19:24:18 [INFO    ] 🔸 root           : Data loading parameters: max_rows=50000, data_percentage=1.0
2025-07-10 19:24:18 [INFO    ] 🔸 root           : Parquet cache found; skipping preprocessing.
2025-07-10 19:24:19 [INFO    ] 🔸 root           : Total data: 40000 train, 10000 test rows
2025-07-10 19:24:19 [INFO    ] 🔸 numba.cuda.cudadrv.driver: init
2025-07-10 19:24:20 [INFO    ] 🔸 VISUALIZATION  : 🎨 Visualization system initialized on port 5000
2025-07-10 19:24:20 [INFO    ] 🔸 VISUALIZATION  : 🌐 Dashboard server started at http://0.0.0.0:5000
2025-07-10 19:24:20 [INFO    ] 🔸 VISUALIZATION  : 🔗 View dashboard at: http://0.0.0.0:5000/trading_dashboard.html
2025-07-10 19:24:20 [INFO    ] 🔸 root           : 🌐 Real-time dashboard available at http://0.0.0.0:5000/trading_dashboard.html
2025-07-10 19:24:20 [INFO    ] 🔸 email_notifications: Email notifications configured for ali.aloraibi@outlook.com
2025-07-10 19:24:20 [INFO    ] 🔸 email_notifications: Notifications will be sent every 6 hours
2025-07-10 19:24:20 [INFO    ] 🔸 email_notifications: No training metrics available for progress update
2025-07-10 19:24:20 [INFO    ] 🔸 email_notifications: Training monitoring started
2025-07-10 19:24:20 [INFO    ] 🔸 root           : 📧 Email notifications enabled
2025-07-10 19:24:20 [INFO    ] 🔸 adaptive_trainer: Removed old TensorBoard run: ./runs/ga_experiment
2025-07-10 19:24:20 [INFO    ] 🔸 adaptive_trainer: Starting adaptive training
2025-07-10 19:24:20 [INFO    ] 🔸 adaptive_trainer:
=== Adaptive Training Iteration 1/5 ===
2025-07-10 19:24:34 [INFO    ] 🔸 adaptive_trainer: Evaluation results: 6779 profits, total=0.0000
2025-07-10 19:24:34 [INFO    ] 🔸 adaptive_trainer: Metrics: CAGR=0.0000, Sharpe=0.0000, MDD=0.0000
2025-07-10 19:24:35 [INFO    ] 🔸 adaptive_trainer: Current performance: 0.0000 (best: 0.0000)
2025-07-10 19:24:35 [INFO    ] 🔸 adaptive_trainer: Stagnation: 0, Poor performance: 0
2025-07-10 19:24:35 [INFO    ] 🔸 adaptive_trainer: Method: GA, Entropy: 1.9459
2025-07-10 19:24:35 [INFO    ] 🔸 adaptive_trainer: Switching to PPO due to: ga_solution_refinement
2025-07-10 19:24:35 [INFO    ] 🔸 adaptive_trainer: Switching from GA to PPO
2025-07-10 19:24:35 [INFO    ] 🔸 adaptive_trainer: Starting PPO phase: 150 updates
2025-07-10 19:24:35 [INFO    ] 🔸 policy_gradient_methods: No model file at models/ppo_models/adaptive_ppo_model.pth, starting from scratch
Removed old TensorBoard run: ./runs/ppo_rank_0
2025-07-10 19:24:46 [INFO    ] 🔸 adaptive_trainer: Evaluation results: 4797 profits, total=0.0000
2025-07-10 19:24:46 [INFO    ] 🔸 adaptive_trainer: Metrics: CAGR=0.0000, Sharpe=0.0000, MDD=0.0000
🎯 Collecting Trajectories:  29%|███████████████████████████▌                                                                    | 294/1024 [00:01<00:02, 260.17it/s, reward=-0.0, eps=0, p_loss=-0.038, v_loss=0.000, progress