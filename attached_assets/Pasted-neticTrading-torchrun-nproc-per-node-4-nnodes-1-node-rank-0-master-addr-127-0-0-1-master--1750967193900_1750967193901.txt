neticTrading$ torchrun --nproc_per_node=4 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=12355 main.py --data-percentage 1.0 --max-rows 0 --adaptive-iterations 20 --log-level INFO
W0625 02:54:22.554000 36634 site-packages/torch/distributed/run.py:766] 
W0625 02:54:22.554000 36634 site-packages/torch/distributed/run.py:766] *****************************************
W0625 02:54:22.554000 36634 site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0625 02:54:22.554000 36634 site-packages/torch/distributed/run.py:766] *****************************************
I0625 02:54:25.428000 36671 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 02:54:25 [INFO    ] [Rank-36671] STARTUP             : ================================================================================
2025-06-25 02:54:25 [INFO    ] [Rank-36671] STARTUP             : Training session started for rank 0
2025-06-25 02:54:25 [INFO    ] [Rank-36671] STARTUP             : Log file: logs/training_rank_0.log
2025-06-25 02:54:25 [INFO    ] [Rank-36671] STARTUP             : Process ID: 36671
2025-06-25 02:54:25 [INFO    ] [Rank-36671] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 02:54:25 [INFO    ] [Rank-36671] STARTUP             : ================================================================================
2025-06-25 02:54:25 [INFO    ] [Rank-36671] root                : NCCL_TIMEOUT = 1800000 ms
2025-06-25 02:54:25 [INFO    ] [Rank-36671] root                : Using 100.0% of available data
2025-06-25 02:54:25 [INFO    ] [Rank-36671] root                : Models will be saved to: ./models
2025-06-25 02:54:25 [INFO    ] [Rank-36671] root                : Rank 0/4 starting on cuda:0 (has_cudf=True)
2025-06-25 02:54:25 [INFO    ] [Rank-36671] root                : Data loading parameters: max_rows=None, data_percentage=1.0
2025-06-25 02:54:25 [INFO    ] [Rank-36671] root                : No row limit specified, using 1M row chunks for memory efficiency
2025-06-25 02:54:25 [INFO    ] [Rank-36671] root                : Processing data with max_rows=None, chunk_size=1000000
2025-06-25 02:54:25 [INFO    ] [Rank-36671] data_preprocessing  : Scanning 1 files for raw data (using chunked reading)...
2025-06-25 02:54:25 [INFO    ] [Rank-36671] data_preprocessing  : Processing file: NQ_full_1min_continuous_absolute_adjusted.txt
2025-06-25 02:54:25 [INFO    ] [Rank-36671] data_preprocessing  : Detected 6 columns in NQ_full_1min_continuous_absolute_adjusted.txt
I0625 02:54:25.526000 36674 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 02:54:25 [INFO    ] [Rank-36674] STARTUP             : ================================================================================
2025-06-25 02:54:25 [INFO    ] [Rank-36674] STARTUP             : Training session started for rank 3
2025-06-25 02:54:25 [INFO    ] [Rank-36674] STARTUP             : Log file: logs/training_rank_3.log
2025-06-25 02:54:25 [INFO    ] [Rank-36674] STARTUP             : Process ID: 36674
2025-06-25 02:54:25 [INFO    ] [Rank-36674] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 02:54:25 [INFO    ] [Rank-36674] STARTUP             : ================================================================================
2025-06-25 02:54:25 [INFO    ] [Rank-36674] root                : Rank 3/4 starting on cuda:3 (has_cudf=True)
2025-06-25 02:54:25 [INFO    ] [Rank-36674] root                : Data loading parameters: max_rows=None, data_percentage=1.0
2025-06-25 02:54:25 [INFO    ] [Rank-36674] root                : No row limit specified, using 1M row chunks for memory efficiency
I0625 02:54:25.640000 36673 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 02:54:25 [INFO    ] [Rank-36673] STARTUP             : ================================================================================
2025-06-25 02:54:25 [INFO    ] [Rank-36673] STARTUP             : Training session started for rank 2
2025-06-25 02:54:25 [INFO    ] [Rank-36673] STARTUP             : Log file: logs/training_rank_2.log
2025-06-25 02:54:25 [INFO    ] [Rank-36673] STARTUP             : Process ID: 36673
2025-06-25 02:54:25 [INFO    ] [Rank-36673] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 02:54:25 [INFO    ] [Rank-36673] STARTUP             : ================================================================================
2025-06-25 02:54:25 [INFO    ] [Rank-36673] root                : Rank 2/4 starting on cuda:2 (has_cudf=True)
2025-06-25 02:54:25 [INFO    ] [Rank-36673] root                : Data loading parameters: max_rows=None, data_percentage=1.0
2025-06-25 02:54:25 [INFO    ] [Rank-36673] root                : No row limit specified, using 1M row chunks for memory efficiency
I0625 02:54:25.676000 36672 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 02:54:25 [INFO    ] [Rank-36672] STARTUP             : ================================================================================
2025-06-25 02:54:25 [INFO    ] [Rank-36672] STARTUP             : Training session started for rank 1
2025-06-25 02:54:25 [INFO    ] [Rank-36672] STARTUP             : Log file: logs/training_rank_1.log
2025-06-25 02:54:25 [INFO    ] [Rank-36672] STARTUP             : Process ID: 36672
2025-06-25 02:54:25 [INFO    ] [Rank-36672] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 02:54:25 [INFO    ] [Rank-36672] STARTUP             : ================================================================================
2025-06-25 02:54:25 [INFO    ] [Rank-36672] root                : Rank 1/4 starting on cuda:1 (has_cudf=True)
2025-06-25 02:54:25 [INFO    ] [Rank-36672] root                : Data loading parameters: max_rows=None, data_percentage=1.0
2025-06-25 02:54:25 [INFO    ] [Rank-36672] root                : No row limit specified, using 1M row chunks for memory efficiency
2025-06-25 02:54:26 [INFO    ] [Rank-36671] numba.cuda.cudadrv.driver: init
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Combining all file chunks...
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Performing comprehensive null data cleaning...
/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/cudf/core/frame.py:784: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  warnings.warn(
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Final clean data: 5389750 rows with no null values
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Caching combined data...
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Cached combined data to ./cached_data/combined_c45aa0ea65a985db5a05afa4579f0ae232581f54055da961dfa91464108f8fc3.parquet
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Processing 5389750 rows in chunks of 1000000
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Processing chunk 1/6
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Starting comprehensive data validation and cleaning...
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Performing final null validation...
2025-06-25 02:54:27 [INFO    ] [Rank-36671] data_preprocessing  : Feature engineering completed: 1000000 rows, no null values
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Processing chunk 2/6
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Starting comprehensive data validation and cleaning...
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Performing final null validation...
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Feature engineering completed: 1000000 rows, no null values
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Processing chunk 3/6
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Starting comprehensive data validation and cleaning...
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Performing final null validation...
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Feature engineering completed: 1000000 rows, no null values
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Processing chunk 4/6
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Starting comprehensive data validation and cleaning...
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Performing final null validation...
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Feature engineering completed: 1000000 rows, no null values
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Processing chunk 5/6
2025-06-25 02:54:28 [INFO    ] [Rank-36671] data_preprocessing  : Starting comprehensive data validation and cleaning...
2025-06-25 02:54:29 [INFO    ] [Rank-36671] data_preprocessing  : Performing final null validation...
2025-06-25 02:54:29 [INFO    ] [Rank-36671] data_preprocessing  : Feature engineering completed: 1000000 rows, no null values
2025-06-25 02:54:29 [INFO    ] [Rank-36671] data_preprocessing  : Processing chunk 6/6
2025-06-25 02:54:29 [INFO    ] [Rank-36671] data_preprocessing  : Starting comprehensive data validation and cleaning...
2025-06-25 02:54:29 [INFO    ] [Rank-36671] data_preprocessing  : Performing final null validation...
2025-06-25 02:54:29 [INFO    ] [Rank-36671] data_preprocessing  : Feature engineering completed: 389750 rows, no null values
2025-06-25 02:54:29 [INFO    ] [Rank-36671] root                : Saving processed data to compressed Parquet...
2025-06-25 02:54:29 [INFO    ] [Rank-36671] root                : Data cached to Parquet and artifacts saved.
alex-System-Product-Name:36671:36671 [0] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:36671:36671 [0] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:36671:36671 [0] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:36671:36671 [0] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:36673:36673 [2] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:36672:36672 [1] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:36674:36674 [3] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:36673:36673 [2] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:36674:36674 [3] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:36672:36672 [1] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:36673:36673 [2] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:36674:36674 [3] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:36672:36672 [1] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:36672:36672 [1] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:36674:36674 [3] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:36673:36673 [2] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:36674:36973 [3] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:36674:36973 [3] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:36674:36973 [3] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:36672:36972 [1] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:36674:36973 [3] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:36674:36973 [3] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:36674:36973 [3] NCCL INFO Using network Socket
alex-System-Product-Name:36672:36972 [1] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:36672:36972 [1] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:36674:36973 [3] NCCL INFO ncclCommInitRankConfig comm 0x63b23727bf90 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 9000 commId 0x544ddd2fc6b22c2a - Init START
alex-System-Product-Name:36672:36972 [1] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:36672:36972 [1] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:36672:36972 [1] NCCL INFO Using network Socket
alex-System-Product-Name:36672:36972 [1] NCCL INFO ncclCommInitRankConfig comm 0x5e9bc70cd580 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 5000 commId 0x544ddd2fc6b22c2a - Init START
alex-System-Product-Name:36671:36971 [0] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:36671:36971 [0] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:36671:36971 [0] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:36671:36971 [0] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:36671:36971 [0] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:36671:36971 [0] NCCL INFO Using network Socket
alex-System-Product-Name:36671:36971 [0] NCCL INFO ncclCommInitRankConfig comm 0x5a84e205dc80 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x544ddd2fc6b22c2a - Init START
alex-System-Product-Name:36673:36974 [2] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:36673:36974 [2] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:36673:36974 [2] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:36673:36974 [2] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:36673:36974 [2] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:36673:36974 [2] NCCL INFO Using network Socket
alex-System-Product-Name:36673:36974 [2] NCCL INFO ncclCommInitRankConfig comm 0x573457e58950 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 8000 commId 0x544ddd2fc6b22c2a - Init START
alex-System-Product-Name:36673:36974 [2] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:36674:36973 [3] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:36672:36972 [1] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:36671:36971 [0] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:36671:36971 [0] NCCL INFO Bootstrap timings total 0.013600 (create 0.000011, send 0.000051, recv 0.000068, ring 0.000620, delay 0.000000)
alex-System-Product-Name:36673:36974 [2] NCCL INFO Bootstrap timings total 0.009050 (create 0.000010, send 0.000048, recv 0.000052, ring 0.008815, delay 0.000000)
alex-System-Product-Name:36672:36972 [1] NCCL INFO Bootstrap timings total 0.018494 (create 0.000015, send 0.000055, recv 0.009469, ring 0.008818, delay 0.000000)
alex-System-Product-Name:36674:36973 [3] NCCL INFO Bootstrap timings total 0.019157 (create 0.000014, send 0.000058, recv 0.005597, ring 0.008816, delay 0.000000)
alex-System-Product-Name:36671:36971 [0] NCCL INFO NVLS multicast support is not available on dev 0
alex-System-Product-Name:36674:36973 [3] NCCL INFO NVLS multicast support is not available on dev 3
alex-System-Product-Name:36672:36972 [1] NCCL INFO NVLS multicast support is not available on dev 1
alex-System-Product-Name:36673:36974 [2] NCCL INFO NVLS multicast support is not available on dev 2
alex-System-Product-Name:36673:36974 [2] NCCL INFO comm 0x573457e58950 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
alex-System-Product-Name:36672:36972 [1] NCCL INFO comm 0x5e9bc70cd580 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
alex-System-Product-Name:36674:36973 [3] NCCL INFO comm 0x63b23727bf90 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
alex-System-Product-Name:36671:36971 [0] NCCL INFO comm 0x5a84e205dc80 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
alex-System-Product-Name:36673:36974 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] -1/-1/-1->2->0 [2] 3/-1/-1->2->1 [3] -1/-1/-1->2->0
alex-System-Product-Name:36672:36972 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 3/-1/-1->1->-1 [2] 2/-1/-1->1->0 [3] 3/-1/-1->1->-1
alex-System-Product-Name:36674:36973 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] 0/-1/-1->3->1 [2] -1/-1/-1->3->2 [3] 0/-1/-1->3->1
alex-System-Product-Name:36671:36971 [0] NCCL INFO Channel 00/04 : 0 2 3 1
alex-System-Product-Name:36673:36974 [2] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:36672:36972 [1] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:36674:36973 [3] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:36671:36971 [0] NCCL INFO Channel 01/04 : 0 1 3 2
alex-System-Product-Name:36671:36971 [0] NCCL INFO Channel 02/04 : 0 2 3 1
alex-System-Product-Name:36671:36971 [0] NCCL INFO Channel 03/04 : 0 1 3 2
alex-System-Product-Name:36671:36971 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 2/-1/-1->0->3 [2] 1/-1/-1->0->-1 [3] 2/-1/-1->0->3
alex-System-Product-Name:36671:36971 [0] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:36671:36971 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
alex-System-Product-Name:36674:36981 [3] NCCL INFO [Proxy Service] Device 3 CPU core 25
alex-System-Product-Name:36673:36983 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 10
alex-System-Product-Name:36671:36986 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 18
alex-System-Product-Name:36672:36985 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 27
alex-System-Product-Name:36671:36982 [0] NCCL INFO [Proxy Service] Device 0 CPU core 20
alex-System-Product-Name:36672:36980 [1] NCCL INFO [Proxy Service] Device 1 CPU core 24
alex-System-Product-Name:36673:36979 [2] NCCL INFO [Proxy Service] Device 2 CPU core 29
alex-System-Product-Name:36674:36984 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 28
alex-System-Product-Name:36674:36973 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:36674:36973 [3] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:36672:36972 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:36672:36972 [1] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:36673:36974 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:36673:36974 [2] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:36671:36971 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:36671:36971 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:36671:36971 [0] NCCL INFO CC Off, workFifoBytes 1048576
alex-System-Product-Name:36673:36974 [2] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:36671:36971 [0] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:36674:36973 [3] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:36672:36972 [1] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:36673:36974 [2] NCCL INFO ncclCommInitRankConfig comm 0x573457e58950 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 8000 commId 0x544ddd2fc6b22c2a - Init COMPLETE
alex-System-Product-Name:36671:36971 [0] NCCL INFO ncclCommInitRankConfig comm 0x5a84e205dc80 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x544ddd2fc6b22c2a - Init COMPLETE
alex-System-Product-Name:36674:36973 [3] NCCL INFO ncclCommInitRankConfig comm 0x63b23727bf90 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 9000 commId 0x544ddd2fc6b22c2a - Init COMPLETE
alex-System-Product-Name:36672:36972 [1] NCCL INFO ncclCommInitRankConfig comm 0x5e9bc70cd580 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 5000 commId 0x544ddd2fc6b22c2a - Init COMPLETE
alex-System-Product-Name:36673:36974 [2] NCCL INFO Init timings - ncclCommInitRankConfig: rank 2 nranks 4 total 0.11 (kernels 0.08, alloc 0.00, bootstrap 0.01, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:36671:36971 [0] NCCL INFO Init timings - ncclCommInitRankConfig: rank 0 nranks 4 total 0.11 (kernels 0.08, alloc 0.00, bootstrap 0.01, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:36674:36973 [3] NCCL INFO Init timings - ncclCommInitRankConfig: rank 3 nranks 4 total 0.11 (kernels 0.07, alloc 0.00, bootstrap 0.02, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:36672:36972 [1] NCCL INFO Init timings - ncclCommInitRankConfig: rank 1 nranks 4 total 0.11 (kernels 0.07, alloc 0.00, bootstrap 0.02, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:36671:36987 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
alex-System-Product-Name:36673:36988 [2] NCCL INFO Channel 00 : 2[2] -> 3[3] via SHM/direct/direct
alex-System-Product-Name:36671:36987 [0] NCCL INFO Channel 03 : 0[0] -> 1[1] via SHM/direct/direct
alex-System-Product-Name:36673:36988 [2] NCCL INFO Channel 02 : 2[2] -> 3[3] via SHM/direct/direct
alex-System-Product-Name:36674:36990 [3] NCCL INFO Channel 00/0 : 3[3] -> 1[1] via P2P/CUMEM
alex-System-Product-Name:36673:36988 [2] NCCL INFO Channel 01/0 : 2[2] -> 0[0] via P2P/CUMEM
alex-System-Product-Name:36674:36990 [3] NCCL INFO Channel 02/0 : 3[3] -> 1[1] via P2P/CUMEM
alex-System-Product-Name:36672:36989 [1] NCCL INFO Channel 01/0 : 1[1] -> 3[3] via P2P/CUMEM
alex-System-Product-Name:36671:36987 [0] NCCL INFO Channel 00/0 : 0[0] -> 2[2] via P2P/CUMEM
alex-System-Product-Name:36673:36988 [2] NCCL INFO Channel 03/0 : 2[2] -> 0[0] via P2P/CUMEM
alex-System-Product-Name:36672:36989 [1] NCCL INFO Channel 03/0 : 1[1] -> 3[3] via P2P/CUMEM
alex-System-Product-Name:36671:36987 [0] NCCL INFO Channel 02/0 : 0[0] -> 2[2] via P2P/CUMEM
alex-System-Product-Name:36674:36990 [3] NCCL INFO Channel 01 : 3[3] -> 2[2] via SHM/direct/direct
alex-System-Product-Name:36672:36989 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
alex-System-Product-Name:36674:36990 [3] NCCL INFO Channel 03 : 3[3] -> 2[2] via SHM/direct/direct
alex-System-Product-Name:36672:36989 [1] NCCL INFO Channel 02 : 1[1] -> 0[0] via SHM/direct/direct
alex-System-Product-Name:36674:36990 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:36672:36989 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:36671:36987 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:36673:36988 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2025-06-25 02:54:30 [INFO    ] [Rank-36671] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 02:54:30 [INFO    ] [Rank-36671] root                : Rank 0: Sampled 100000 train rows from 4311800 total
2025-06-25 02:54:30 [INFO    ] [Rank-36671] root                : Rank 0: Sampled 20000 test rows from 1077950 total
2025-06-25 02:54:30 [INFO    ] [Rank-36674] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 02:54:30 [INFO    ] [Rank-36672] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 02:54:30 [INFO    ] [Rank-36672] root                : Rank 1: Sampled 100000 train rows from 4311800 total
2025-06-25 02:54:30 [INFO    ] [Rank-36674] root                : Rank 3: Sampled 100000 train rows from 4311800 total
2025-06-25 02:54:30 [INFO    ] [Rank-36672] root                : Rank 1: Sampled 20000 test rows from 1077950 total
2025-06-25 02:54:30 [INFO    ] [Rank-36672] numba.cuda.cudadrv.driver: init
2025-06-25 02:54:30 [INFO    ] [Rank-36674] root                : Rank 3: Sampled 20000 test rows from 1077950 total
2025-06-25 02:54:30 [INFO    ] [Rank-36674] numba.cuda.cudadrv.driver: init
2025-06-25 02:54:30 [INFO    ] [Rank-36673] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 02:54:30 [INFO    ] [Rank-36673] root                : Rank 2: Sampled 100000 train rows from 4311800 total
2025-06-25 02:54:30 [INFO    ] [Rank-36673] root                : Rank 2: Sampled 20000 test rows from 1077950 total
2025-06-25 02:54:30 [INFO    ] [Rank-36673] numba.cuda.cudadrv.driver: init
2025-06-25 02:54:32 [INFO    ] [Rank-36673] root                : Non-rank 0 process waiting for adaptive training to complete
2025-06-25 02:54:32 [INFO    ] [Rank-36674] root                : Non-rank 0 process waiting for adaptive training to complete
2025-06-25 02:54:33 [INFO    ] [Rank-36671] email_notifications : Email notifications configured for ali.aloraibi@outlook.com
2025-06-25 02:54:33 [INFO    ] [Rank-36671] email_notifications : Notifications will be sent every 6 hours
2025-06-25 02:54:33 [INFO    ] [Rank-36671] email_notifications : No training metrics available for progress update
2025-06-25 02:54:33 [INFO    ] [Rank-36671] email_notifications : Training monitoring started
2025-06-25 02:54:33 [INFO    ] [Rank-36671] root                : Email notifications enabled - reports every 6 hours
2025-06-25 02:54:33 [INFO    ] [Rank-36672] root                : Non-rank 0 process waiting for adaptive training to complete
2025-06-25 02:54:33 [INFO    ] [Rank-36671] adaptive_trainer    : Removed old TensorBoard run: ./runs/ga_experiment
2025-06-25 02:54:33 [INFO    ] [Rank-36671] adaptive_trainer    : Starting adaptive training
2025-06-25 02:54:33 [INFO    ] [Rank-36671] adaptive_trainer    : 
=== Adaptive Training Iteration 1/20 ===
2025-06-25 02:54:40 [INFO    ] [Rank-36671] adaptive_trainer    : Evaluation results: 19537 profits, total=2341089318792.1631
2025-06-25 02:54:40 [INFO    ] [Rank-36671] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:54:40 [INFO    ] [Rank-36671] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 02:54:40 [INFO    ] [Rank-36671] adaptive_trainer    : Stagnation: 0, Poor performance: 0
2025-06-25 02:54:40 [INFO    ] [Rank-36671] adaptive_trainer    : Method: GA, Entropy: 1.0986
2025-06-25 02:54:40 [INFO    ] [Rank-36671] adaptive_trainer    : Switching to PPO due to: good_performance_refinement, ga_solution_refinement
2025-06-25 02:54:40 [INFO    ] [Rank-36671] adaptive_trainer    : Switching from GA to PPO
2025-06-25 02:54:40 [INFO    ] [Rank-36671] adaptive_trainer    : Starting PPO phase: 150 updates
2025-06-25 02:54:40 [INFO    ] [Rank-36671] policy_gradient_methods: No model file at models/ppo_models/adaptive_ppo_model.pth, starting from scratch
[rank0]:I0625 02:54:40.435000 36671 site-packages/torch/distributed/nn/jit/instantiator.py:24] Created a temporary directory at /tmp/tmp1wrf_lbk
[rank0]:I0625 02:54:40.435000 36671 site-packages/torch/distributed/nn/jit/instantiator.py:75] Writing /tmp/tmp1wrf_lbk/_remote_module_non_scriptable.py
Removed old TensorBoard run: ./runs/ppo_rank_0
2025-06-25 02:54:43 [INFO    ] [Rank-36671] adaptive_trainer    : Evaluation results: 8881 profits, total=401424010070.6420
2025-06-25 02:54:43 [INFO    ] [Rank-36671] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:55:37 [INFO    ] [Rank-36671] adaptive_trainer    : Evaluation results: 6018 profits, total=177086837261.3156                                                                                                
2025-06-25 02:55:37 [INFO    ] [Rank-36671] adaptive_trainer    : Metrics: CAGR=120.6059, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:55:37 [INFO    ] [Rank-36671] adaptive_trainer    : PPO Update 50: Performance=0.5518, Entropy=1.0986
2025-06-25 02:56:31 [INFO    ] [Rank-36671] adaptive_trainer    : Evaluation results: 4913 profits, total=117924492499.2197                                                                                                
2025-06-25 02:56:31 [INFO    ] [Rank-36671] adaptive_trainer    : Metrics: CAGR=101.9116, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:56:31 [INFO    ] [Rank-36671] adaptive_trainer    : PPO Update 100: Performance=0.4957, Entropy=1.0986
2025-06-25 02:57:23 [INFO    ] [Rank-36671] adaptive_trainer    : Evaluation results: 1595 profits, total=12755334379.5653                                                                                                 
2025-06-25 02:57:23 [INFO    ] [Rank-36671] adaptive_trainer    : Metrics: CAGR=110.2016, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:57:23 [INFO    ] [Rank-36671] adaptive_trainer    : PPO Update 150: Performance=0.5206, Entropy=1.0986
2025-06-25 02:57:23 [WARNING ] [Rank-36671] adaptive_trainer    : PPO early stopping due to lack of improvement (patience: 3)
2025-06-25 02:57:23 [INFO    ] [Rank-36671] policy_gradient_methods: Saved model to models/ppo_models/adaptive_ppo_model.pth at 2025-06-25 02:57:23.983824
2025-06-25 02:57:24 [INFO    ] [Rank-36671] adaptive_trainer    : Evaluation results: 2374 profits, total=307851276508.0608
2025-06-25 02:57:24 [INFO    ] [Rank-36671] adaptive_trainer    : Metrics: CAGR=120.0481, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:57:24 [INFO    ] [Rank-36671] adaptive_trainer    : PPO phase completed with performance: 0.5501
2025-06-25 02:57:24 [INFO    ] [Rank-36671] adaptive_trainer    : 
=== Adaptive Training Iteration 2/20 ===
2025-06-25 02:57:25 [INFO    ] [Rank-36671] adaptive_trainer    : Evaluation results: 2037 profits, total=229718543848.5961
2025-06-25 02:57:25 [INFO    ] [Rank-36671] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:57:25 [INFO    ] [Rank-36671] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 02:57:25 [INFO    ] [Rank-36671] adaptive_trainer    : Stagnation: 1, Poor performance: 0
2025-06-25 02:57:25 [INFO    ] [Rank-36671] adaptive_trainer    : Method: PPO, Entropy: 0.5632
2025-06-25 02:57:25 [INFO    ] [Rank-36671] adaptive_trainer    : Switching to GA due to: exploration_phase
2025-06-25 02:57:25 [INFO    ] [Rank-36671] adaptive_trainer    : Switching from PPO to GA
2025-06-25 02:57:25 [INFO    ] [Rank-36671] adaptive_trainer    : Starting GA phase: 20 generations, population 20
[GA] No model file at models/ga_models/adaptive_ga_model.pth, starting from scratch                                     
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=15735.8, max=7384697.7, stg=0:  10%|███▌                               | 1/10 [24:33<3:40:58, 1473.18s/it][rank2]:[E625 03:24:32.979296419 ProcessGroupNCCL.cpp:632] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=1800000) ran for 1800009 milliseconds before timing out.
[rank2]:[E625 03:24:32.980847719 ProcessGroupNCCL.cpp:2268] [PG ID 0 PG GUID 0(default_pg) Rank 2]  failure detected by watchdog at work sequence id: 2 PG status: last enqueued work: 2, last completed work: 1
[rank2]:[E625 03:24:32.980854919 ProcessGroupNCCL.cpp:670] Stack trace of the failed collective not found, potentially because FlightRecorder is disabled. You can enable it by setting TORCH_NCCL_TRACE_BUFFER_SIZE to a non-zero value.
[rank2]:[E625 03:24:32.980876556 ProcessGroupNCCL.cpp:2103] [PG ID 0 PG GUID 0(default_pg) Rank 2] First PG on this rank to signal dumping.
[rank3]:[E625 03:24:33.089668066 ProcessGroupNCCL.cpp:632] [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=1800000) ran for 1800099 milliseconds before timing out.
[rank3]:[E625 03:24:33.089804819 ProcessGroupNCCL.cpp:2268] [PG ID 0 PG GUID 0(default_pg) Rank 3]  failure detected by watchdog at work sequence id: 2 PG status: last enqueued work: 2, last completed work: 1
[rank3]:[E625 03:24:33.089809080 ProcessGroupNCCL.cpp:670] Stack trace of the failed collective not found, potentially because FlightRecorder is disabled. You can enable it by setting TORCH_NCCL_TRACE_BUFFER_SIZE to a non-zero value.
[rank3]:[E625 03:24:33.089830417 ProcessGroupNCCL.cpp:2103] [PG ID 0 PG GUID 0(default_pg) Rank 3] First PG on this rank to signal dumping.
[rank1]:[E625 03:24:33.204852544 ProcessGroupNCCL.cpp:632] [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=1800000) ran for 1800051 milliseconds before timing out.
[rank1]:[E625 03:24:33.205020419 ProcessGroupNCCL.cpp:2268] [PG ID 0 PG GUID 0(default_pg) Rank 1]  failure detected by watchdog at work sequence id: 2 PG status: last enqueued work: 2, last completed work: 1
[rank1]:[E625 03:24:33.205025321 ProcessGroupNCCL.cpp:670] Stack trace of the failed collective not found, potentially because FlightRecorder is disabled. You can enable it by setting TORCH_NCCL_TRACE_BUFFER_SIZE to a non-zero value.
[rank1]:[E625 03:24:33.205065805 ProcessGroupNCCL.cpp:2103] [PG ID 0 PG GUID 0(default_pg) Rank 1] First PG on this rank to signal dumping.
[rank2]:[E625 03:24:33.258673965 ProcessGroupNCCL.cpp:1743] [PG ID 0 PG GUID 0(default_pg) Rank 2] Received a dump signal due to a collective timeout from this local rank and we will try our best to dump the debug info. Last enqueued NCCL work: 2, last completed NCCL work: 1.This is most likely caused by incorrect usages of collectives, e.g., wrong sizes used across ranks, the order of collectives is not same for all ranks or the scheduled collective, for some reason, didn't run. Additionally, this can be caused by GIL deadlock or other reasons such as network errors or bugs in the communications library (e.g. NCCL), etc. 
[rank2]:[E625 03:24:33.258837592 ProcessGroupNCCL.cpp:1533] [PG ID 0 PG GUID 0(default_pg) Rank 2] ProcessGroupNCCL preparing to dump debug info. Include stack trace: 1
alex-System-Product-Name:36673:39804 [2] NCCL INFO misc/socket.cc:64 -> 3
alex-System-Product-Name:36673:39804 [2] NCCL INFO misc/socket.cc:80 -> 3
alex-System-Product-Name:36673:39804 [2] NCCL INFO misc/socket.cc:829 -> 3
alex-System-Product-Name:36673:39804 [2] NCCL INFO misc/socket.cc:64 -> 3
alex-System-Product-Name:36673:39804 [2] NCCL INFO misc/socket.cc:80 -> 3
alex-System-Product-Name:36673:39804 [2] NCCL INFO misc/socket.cc:829 -> 3
alex-System-Product-Name:36673:36979 [2] NCCL INFO misc/socket.cc:881 -> 3
[rank1]:[E625 03:24:33.269275017 ProcessGroupNCCL.cpp:1743] [PG ID 0 PG GUID 0(default_pg) Rank 1] Received a dump signal due to a collective timeout from this local rank and we will try our best to dump the debug info. Last enqueued NCCL work: 2, last completed NCCL work: 1.This is most likely caused by incorrect usages of collectives, e.g., wrong sizes used across ranks, the order of collectives is not same for all ranks or the scheduled collective, for some reason, didn't run. Additionally, this can be caused by GIL deadlock or other reasons such as network errors or bugs in the communications library (e.g. NCCL), etc. 
[rank3]:[E625 03:24:33.269275029 ProcessGroupNCCL.cpp:1743] [PG ID 0 PG GUID 0(default_pg) Rank 3] Received a dump signal due to a collective timeout from this local rank and we will try our best to dump the debug info. Last enqueued NCCL work: 2, last completed NCCL work: 1.This is most likely caused by incorrect usages of collectives, e.g., wrong sizes used across ranks, the order of collectives is not same for all ranks or the scheduled collective, for some reason, didn't run. Additionally, this can be caused by GIL deadlock or other reasons such as network errors or bugs in the communications library (e.g. NCCL), etc. 
[rank3]:[E625 03:24:33.269345377 ProcessGroupNCCL.cpp:1533] [PG ID 0 PG GUID 0(default_pg) Rank 3] ProcessGroupNCCL preparing to dump debug info. Include stack trace: 1
[rank1]:[E625 03:24:33.269407762 ProcessGroupNCCL.cpp:1533] [PG ID 0 PG GUID 0(default_pg) Rank 1] ProcessGroupNCCL preparing to dump debug info. Include stack trace: 1
alex-System-Product-Name:36674:39811 [3] NCCL INFO comm 0x63b23727bf90 rank 3 nranks 4 cudaDev 3 busId 9000 - Abort COMPLETE
[rank3]:[E625 03:24:33.328761698 ProcessGroupNCCL.cpp:684] [Rank 3] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank3]:[E625 03:24:33.328770146 ProcessGroupNCCL.cpp:698] [Rank 3] To avoid data inconsistency, we are taking the entire process down.
[rank3]:[E625 03:24:33.329473464 ProcessGroupNCCL.cpp:1896] [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=1800000) ran for 1800099 milliseconds before timing out.
Exception raised from checkTimeout at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:635 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x764b2d3785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x23d (0x764ad2fe2a1d in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0xc80 (0x764ad2fe47a0 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x764ad2fe5ead in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd3b6d (0x764b2cef1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #5: <unknown function> + 0x94ac3 (0x764b2e694ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x764b2e726850 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=1800000) ran for 1800099 milliseconds before timing out.
Exception raised from checkTimeout at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:635 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x764b2d3785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x23d (0x764ad2fe2a1d in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0xc80 (0x764ad2fe47a0 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x764ad2fe5ead in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd3b6d (0x764b2cef1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #5: <unknown function> + 0x94ac3 (0x764b2e694ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x764b2e726850 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1902 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x764b2d3785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x11b4a6e (0x764ad2fb4a6e in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xe07bed (0x764ad2c07bed in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: <unknown function> + 0xd3b6d (0x764b2cef1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #4: <unknown function> + 0x94ac3 (0x764b2e694ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #5: <unknown function> + 0x126850 (0x764b2e726850 in /lib/x86_64-linux-gnu/libc.so.6)

W0625 03:24:33.412000 36634 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 36671 closing signal SIGTERM
W0625 03:24:33.413000 36634 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 36672 closing signal SIGTERM
W0625 03:24:33.413000 36634 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 36673 closing signal SIGTERM
/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/multiprocessing/resource_tracker.py:255: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
E0625 03:24:33.576000 36634 site-packages/torch/distributed/elastic/multiprocessing/api.py:874] failed (exitcode: -6) local_rank: 3 (pid: 36674) of binary: /home/alex/miniconda3/envs/GeneticTrading/bin/python3.12
Traceback (most recent call last):
  File "/home/alex/miniconda3/envs/GeneticTrading/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/run.py", line 892, in main
    run(args)
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/run.py", line 883, in run
    elastic_launch(
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 270, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
======================================================
main.py FAILED
------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-06-25_03:24:33
  host      : alex-System-Product-Name
  rank      : 3 (local_rank: 3)
  exitcode  : -6 (pid: 36674)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 36674
======================================================
(GeneticTrading) alex@alex-System-Product-Name:/mnt/windows/GeneticTrading$ lfkill -f torchrun
Command 'lfkill' not found, did you mean:
  command 'fkill' from snap fkill (v8.0.0)
  command 'rfkill' from deb rfkill (2.37.2-4ubuntu3.4)
See 'snap info <snapname>' for additional versions.
(GeneticTrading) alex@alex-System-Product-Name:/mnt/windows/GeneticTrading$ pkill -f torchrun
(GeneticTrading) alex@alex-System-Product-Name:/mnt/windows/GeneticTrading$ export NCCL_TIMEOUT=7200000
(GeneticTrading) alex@alex-System-Product-Name:/mnt/windows/GeneticTrading$ export NCCL_DEBUG=WARN
(GeneticTrading) alex@alex-System-Product-Name:/mnt/windows/GeneticTrading$ export TORCH_NCCL_TRACE_BUFFER_SIZE=1000
(GeneticTrading) alex@alex-System-Product-Name:/mnt/windows/GeneticTrading$ torchrun --nproc_per_node=4 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=12356 main.py --data-percentage 0.5 --max-rows 500000 --adaptive-iterations 10 --log-level INFO --nccl-timeout 7200000
W0625 10:50:18.471000 70685 site-packages/torch/distributed/run.py:766] 
W0625 10:50:18.471000 70685 site-packages/torch/distributed/run.py:766] *****************************************
W0625 10:50:18.471000 70685 site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0625 10:50:18.471000 70685 site-packages/torch/distributed/run.py:766] *****************************************
I0625 10:50:20.712000 70718 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 10:50:20 [INFO    ] [Rank-70718] STARTUP             : ================================================================================
2025-06-25 10:50:20 [INFO    ] [Rank-70718] STARTUP             : Training session started for rank 0
2025-06-25 10:50:20 [INFO    ] [Rank-70718] STARTUP             : Log file: logs/training_rank_0.log
2025-06-25 10:50:20 [INFO    ] [Rank-70718] STARTUP             : Process ID: 70718
2025-06-25 10:50:20 [INFO    ] [Rank-70718] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 10:50:20 [INFO    ] [Rank-70718] STARTUP             : ================================================================================
2025-06-25 10:50:20 [INFO    ] [Rank-70718] root                : NCCL_TIMEOUT = 7200000 ms
2025-06-25 10:50:20 [INFO    ] [Rank-70718] root                : Using 50.0% of available data
2025-06-25 10:50:20 [INFO    ] [Rank-70718] root                : Models will be saved to: ./models
2025-06-25 10:50:20 [INFO    ] [Rank-70718] root                : Rank 0/4 starting on cuda:0 (has_cudf=True)
2025-06-25 10:50:20 [INFO    ] [Rank-70718] root                : Data loading parameters: max_rows=500000, data_percentage=0.5
2025-06-25 10:50:20 [INFO    ] [Rank-70718] root                : Adjusted max_rows to 250000 based on data_percentage
2025-06-25 10:50:20 [INFO    ] [Rank-70718] root                : Parquet cache found; skipping preprocessing.
alex-System-Product-Name:70718:70718 [0] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:70718:70718 [0] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:70718:70718 [0] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:70718:70718 [0] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:70718:70771 [0] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:70718:70771 [0] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:70718:70771 [0] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:70718:70771 [0] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:70718:70771 [0] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:70718:70771 [0] NCCL INFO Using network Socket
alex-System-Product-Name:70718:70771 [0] NCCL INFO ncclCommInitRankConfig comm 0x5a4836ed9eb0 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x6cbab2ac3b23a0ab - Init START
I0625 10:50:20.873000 70721 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
I0625 10:50:20.873000 70719 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 10:50:20 [INFO    ] [Rank-70721] STARTUP             : ================================================================================
2025-06-25 10:50:20 [INFO    ] [Rank-70719] STARTUP             : ================================================================================
2025-06-25 10:50:20 [INFO    ] [Rank-70721] STARTUP             : Training session started for rank 3
2025-06-25 10:50:20 [INFO    ] [Rank-70719] STARTUP             : Training session started for rank 1
2025-06-25 10:50:20 [INFO    ] [Rank-70721] STARTUP             : Log file: logs/training_rank_3.log
2025-06-25 10:50:20 [INFO    ] [Rank-70719] STARTUP             : Log file: logs/training_rank_1.log
2025-06-25 10:50:20 [INFO    ] [Rank-70721] STARTUP             : Process ID: 70721
2025-06-25 10:50:20 [INFO    ] [Rank-70719] STARTUP             : Process ID: 70719
2025-06-25 10:50:20 [INFO    ] [Rank-70721] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 10:50:20 [INFO    ] [Rank-70719] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 10:50:20 [INFO    ] [Rank-70721] STARTUP             : ================================================================================
2025-06-25 10:50:20 [INFO    ] [Rank-70719] STARTUP             : ================================================================================
2025-06-25 10:50:20 [INFO    ] [Rank-70721] root                : Rank 3/4 starting on cuda:3 (has_cudf=True)
2025-06-25 10:50:20 [INFO    ] [Rank-70719] root                : Rank 1/4 starting on cuda:1 (has_cudf=True)
2025-06-25 10:50:20 [INFO    ] [Rank-70721] root                : Data loading parameters: max_rows=500000, data_percentage=0.5
2025-06-25 10:50:20 [INFO    ] [Rank-70719] root                : Data loading parameters: max_rows=500000, data_percentage=0.5
2025-06-25 10:50:20 [INFO    ] [Rank-70721] root                : Adjusted max_rows to 250000 based on data_percentage
2025-06-25 10:50:20 [INFO    ] [Rank-70719] root                : Adjusted max_rows to 250000 based on data_percentage
I0625 10:50:20.879000 70720 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 10:50:20 [INFO    ] [Rank-70720] STARTUP             : ================================================================================
2025-06-25 10:50:20 [INFO    ] [Rank-70720] STARTUP             : Training session started for rank 2
2025-06-25 10:50:20 [INFO    ] [Rank-70720] STARTUP             : Log file: logs/training_rank_2.log
2025-06-25 10:50:20 [INFO    ] [Rank-70720] STARTUP             : Process ID: 70720
2025-06-25 10:50:20 [INFO    ] [Rank-70720] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 10:50:20 [INFO    ] [Rank-70720] STARTUP             : ================================================================================
2025-06-25 10:50:20 [INFO    ] [Rank-70720] root                : Rank 2/4 starting on cuda:2 (has_cudf=True)
2025-06-25 10:50:20 [INFO    ] [Rank-70720] root                : Data loading parameters: max_rows=500000, data_percentage=0.5
2025-06-25 10:50:20 [INFO    ] [Rank-70720] root                : Adjusted max_rows to 250000 based on data_percentage
alex-System-Product-Name:70721:70721 [3] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:70719:70719 [1] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:70721:70721 [3] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:70719:70719 [1] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:70721:70721 [3] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:70719:70719 [1] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:70719:70719 [1] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:70721:70721 [3] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:70720:70720 [2] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:70720:70720 [2] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:70720:70720 [2] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:70720:70720 [2] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:70719:70781 [1] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:70721:70782 [3] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:70721:70782 [3] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:70719:70781 [1] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:70721:70782 [3] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:70719:70781 [1] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:70719:70781 [1] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:70721:70782 [3] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:70719:70781 [1] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:70721:70782 [3] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:70719:70781 [1] NCCL INFO Using network Socket
alex-System-Product-Name:70721:70782 [3] NCCL INFO Using network Socket
alex-System-Product-Name:70721:70782 [3] NCCL INFO ncclCommInitRankConfig comm 0x65142cbd14f0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 9000 commId 0x6cbab2ac3b23a0ab - Init START
alex-System-Product-Name:70719:70781 [1] NCCL INFO ncclCommInitRankConfig comm 0x651095fc50e0 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 5000 commId 0x6cbab2ac3b23a0ab - Init START
alex-System-Product-Name:70718:70771 [0] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:70720:70783 [2] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:70720:70783 [2] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:70720:70783 [2] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:70720:70783 [2] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:70720:70783 [2] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:70720:70783 [2] NCCL INFO Using network Socket
alex-System-Product-Name:70720:70783 [2] NCCL INFO ncclCommInitRankConfig comm 0x5ac3d1c617b0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 8000 commId 0x6cbab2ac3b23a0ab - Init START
alex-System-Product-Name:70720:70783 [2] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:70719:70781 [1] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:70721:70782 [3] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:70721:70782 [3] NCCL INFO Bootstrap timings total 0.016480 (create 0.000013, send 0.000054, recv 0.000156, ring 0.000022, delay 0.000000)
alex-System-Product-Name:70720:70783 [2] NCCL INFO Bootstrap timings total 0.000340 (create 0.000013, send 0.000050, recv 0.000070, ring 0.000116, delay 0.000000)
alex-System-Product-Name:70719:70781 [1] NCCL INFO Bootstrap timings total 0.016481 (create 0.000012, send 0.000058, recv 0.016190, ring 0.000103, delay 0.000000)
alex-System-Product-Name:70718:70771 [0] NCCL INFO Bootstrap timings total 0.100250 (create 0.000013, send 0.000063, recv 0.083847, ring 0.004617, delay 0.000000)
alex-System-Product-Name:70721:70782 [3] NCCL INFO NVLS multicast support is not available on dev 3
alex-System-Product-Name:70719:70781 [1] NCCL INFO NVLS multicast support is not available on dev 1
alex-System-Product-Name:70718:70771 [0] NCCL INFO NVLS multicast support is not available on dev 0
alex-System-Product-Name:70720:70783 [2] NCCL INFO NVLS multicast support is not available on dev 2
alex-System-Product-Name:70720:70783 [2] NCCL INFO comm 0x5ac3d1c617b0 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
alex-System-Product-Name:70719:70781 [1] NCCL INFO comm 0x651095fc50e0 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
alex-System-Product-Name:70721:70782 [3] NCCL INFO comm 0x65142cbd14f0 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
alex-System-Product-Name:70718:70771 [0] NCCL INFO comm 0x5a4836ed9eb0 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
alex-System-Product-Name:70720:70783 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] -1/-1/-1->2->0 [2] 3/-1/-1->2->1 [3] -1/-1/-1->2->0
alex-System-Product-Name:70719:70781 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 3/-1/-1->1->-1 [2] 2/-1/-1->1->0 [3] 3/-1/-1->1->-1
alex-System-Product-Name:70718:70771 [0] NCCL INFO Channel 00/04 : 0 2 3 1
alex-System-Product-Name:70721:70782 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] 0/-1/-1->3->1 [2] -1/-1/-1->3->2 [3] 0/-1/-1->3->1
alex-System-Product-Name:70720:70783 [2] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:70719:70781 [1] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:70718:70771 [0] NCCL INFO Channel 01/04 : 0 1 3 2
alex-System-Product-Name:70721:70782 [3] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:70718:70771 [0] NCCL INFO Channel 02/04 : 0 2 3 1
alex-System-Product-Name:70718:70771 [0] NCCL INFO Channel 03/04 : 0 1 3 2
alex-System-Product-Name:70718:70771 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 2/-1/-1->0->3 [2] 1/-1/-1->0->-1 [3] 2/-1/-1->0->3
alex-System-Product-Name:70718:70771 [0] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:70718:70771 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
alex-System-Product-Name:70719:70792 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 24
alex-System-Product-Name:70718:70795 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 20
alex-System-Product-Name:70721:70788 [3] NCCL INFO [Proxy Service] Device 3 CPU core 4
alex-System-Product-Name:70720:70793 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 18
alex-System-Product-Name:70721:70794 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 16
alex-System-Product-Name:70719:70791 [1] NCCL INFO [Proxy Service] Device 1 CPU core 28
alex-System-Product-Name:70718:70789 [0] NCCL INFO [Proxy Service] Device 0 CPU core 4
alex-System-Product-Name:70720:70790 [2] NCCL INFO [Proxy Service] Device 2 CPU core 21
alex-System-Product-Name:70721:70782 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:70721:70782 [3] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:70720:70783 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:70720:70783 [2] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:70719:70781 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:70719:70781 [1] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:70718:70771 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:70718:70771 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:70718:70771 [0] NCCL INFO CC Off, workFifoBytes 1048576
alex-System-Product-Name:70721:70782 [3] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:70719:70781 [1] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:70721:70782 [3] NCCL INFO ncclCommInitRankConfig comm 0x65142cbd14f0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 9000 commId 0x6cbab2ac3b23a0ab - Init COMPLETE
alex-System-Product-Name:70719:70781 [1] NCCL INFO ncclCommInitRankConfig comm 0x651095fc50e0 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 5000 commId 0x6cbab2ac3b23a0ab - Init COMPLETE
alex-System-Product-Name:70721:70782 [3] NCCL INFO Init timings - ncclCommInitRankConfig: rank 3 nranks 4 total 0.11 (kernels 0.07, alloc 0.00, bootstrap 0.02, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:70719:70781 [1] NCCL INFO Init timings - ncclCommInitRankConfig: rank 1 nranks 4 total 0.11 (kernels 0.07, alloc 0.00, bootstrap 0.02, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:70720:70783 [2] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:70720:70783 [2] NCCL INFO ncclCommInitRankConfig comm 0x5ac3d1c617b0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 8000 commId 0x6cbab2ac3b23a0ab - Init COMPLETE
alex-System-Product-Name:70720:70783 [2] NCCL INFO Init timings - ncclCommInitRankConfig: rank 2 nranks 4 total 0.10 (kernels 0.08, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:70718:70771 [0] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:70718:70771 [0] NCCL INFO ncclCommInitRankConfig comm 0x5a4836ed9eb0 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x6cbab2ac3b23a0ab - Init COMPLETE
alex-System-Product-Name:70718:70771 [0] NCCL INFO Init timings - ncclCommInitRankConfig: rank 0 nranks 4 total 0.25 (kernels 0.13, alloc 0.00, bootstrap 0.10, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:70718:70797 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
alex-System-Product-Name:70720:70799 [2] NCCL INFO Channel 00 : 2[2] -> 3[3] via SHM/direct/direct
alex-System-Product-Name:70718:70797 [0] NCCL INFO Channel 03 : 0[0] -> 1[1] via SHM/direct/direct
alex-System-Product-Name:70720:70799 [2] NCCL INFO Channel 02 : 2[2] -> 3[3] via SHM/direct/direct
alex-System-Product-Name:70720:70799 [2] NCCL INFO Channel 01/0 : 2[2] -> 0[0] via P2P/CUMEM
alex-System-Product-Name:70719:70798 [1] NCCL INFO Channel 01/0 : 1[1] -> 3[3] via P2P/CUMEM
alex-System-Product-Name:70720:70799 [2] NCCL INFO Channel 03/0 : 2[2] -> 0[0] via P2P/CUMEM
alex-System-Product-Name:70718:70797 [0] NCCL INFO Channel 00/0 : 0[0] -> 2[2] via P2P/CUMEM
alex-System-Product-Name:70721:70796 [3] NCCL INFO Channel 00/0 : 3[3] -> 1[1] via P2P/CUMEM
alex-System-Product-Name:70719:70798 [1] NCCL INFO Channel 03/0 : 1[1] -> 3[3] via P2P/CUMEM
alex-System-Product-Name:70718:70797 [0] NCCL INFO Channel 02/0 : 0[0] -> 2[2] via P2P/CUMEM
alex-System-Product-Name:70721:70796 [3] NCCL INFO Channel 02/0 : 3[3] -> 1[1] via P2P/CUMEM
alex-System-Product-Name:70721:70796 [3] NCCL INFO Channel 01 : 3[3] -> 2[2] via SHM/direct/direct
alex-System-Product-Name:70719:70798 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
alex-System-Product-Name:70721:70796 [3] NCCL INFO Channel 03 : 3[3] -> 2[2] via SHM/direct/direct
alex-System-Product-Name:70719:70798 [1] NCCL INFO Channel 02 : 1[1] -> 0[0] via SHM/direct/direct
alex-System-Product-Name:70718:70797 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:70721:70796 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:70720:70799 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:70719:70798 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2025-06-25 10:50:21 [INFO    ] [Rank-70718] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 10:50:21 [INFO    ] [Rank-70718] root                : Rank 0: Sampled 100000 train rows from 4311800 total
2025-06-25 10:50:21 [INFO    ] [Rank-70718] root                : Rank 0: Sampled 20000 test rows from 1077950 total
2025-06-25 10:50:21 [INFO    ] [Rank-70718] numba.cuda.cudadrv.driver: init
2025-06-25 10:50:21 [INFO    ] [Rank-70719] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 10:50:21 [INFO    ] [Rank-70719] root                : Rank 1: Sampled 100000 train rows from 4311800 total
2025-06-25 10:50:21 [INFO    ] [Rank-70719] root                : Rank 1: Sampled 20000 test rows from 1077950 total
2025-06-25 10:50:21 [INFO    ] [Rank-70719] numba.cuda.cudadrv.driver: init
2025-06-25 10:50:21 [INFO    ] [Rank-70721] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 10:50:21 [INFO    ] [Rank-70721] root                : Rank 3: Sampled 100000 train rows from 4311800 total
2025-06-25 10:50:21 [INFO    ] [Rank-70721] root                : Rank 3: Sampled 20000 test rows from 1077950 total
2025-06-25 10:50:21 [INFO    ] [Rank-70721] numba.cuda.cudadrv.driver: init
2025-06-25 10:50:21 [INFO    ] [Rank-70720] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 10:50:21 [INFO    ] [Rank-70720] root                : Rank 2: Sampled 100000 train rows from 4311800 total
2025-06-25 10:50:21 [INFO    ] [Rank-70720] root                : Rank 2: Sampled 20000 test rows from 1077950 total
2025-06-25 10:50:21 [INFO    ] [Rank-70720] numba.cuda.cudadrv.driver: init
2025-06-25 10:50:23 [INFO    ] [Rank-70718] email_notifications : Email notifications configured for ali.aloraibi@outlook.com
2025-06-25 10:50:23 [INFO    ] [Rank-70718] email_notifications : Notifications will be sent every 6 hours
2025-06-25 10:50:23 [INFO    ] [Rank-70718] email_notifications : No training metrics available for progress update
2025-06-25 10:50:23 [INFO    ] [Rank-70718] email_notifications : Training monitoring started
2025-06-25 10:50:23 [INFO    ] [Rank-70718] root                : Email notifications enabled - reports every 6 hours
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/windows/GeneticTrading/main.py", line 580, in <module>
[rank0]:     main()
[rank0]:   File "/mnt/windows/GeneticTrading/main.py", line 494, in main
[rank0]:     adaptive_trainer = AdaptiveTrainer(
[rank0]:                        ^^^^^^^^^^^^^^^^
[rank0]: TypeError: AdaptiveTrainer.__init__() got an unexpected keyword argument 'world_size'
2025-06-25 10:50:23 [INFO    ] [Rank-70719] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 10:50:23 [INFO    ] [Rank-70721] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 10:50:23 [INFO    ] [Rank-70720] root                : Rank 2 heartbeat - waiting for adaptive training
alex-System-Product-Name:70720:70790 [2] NCCL INFO [Service thread] Connection closed by localRank 0
W0625 10:50:23.583000 70685 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 70719 closing signal SIGTERM
W0625 10:50:23.583000 70685 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 70720 closing signal SIGTERM
W0625 10:50:23.583000 70685 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 70721 closing signal SIGTERM
E0625 10:50:23.761000 70685 site-packages/torch/distributed/elastic/multiprocessing/api.py:874] failed (exitcode: 1) local_rank: 0 (pid: 70718) of binary: /home/alex/miniconda3/envs/GeneticTrading/bin/python3.12
Traceback (most recent call last):
  File "/home/alex/miniconda3/envs/GeneticTrading/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/run.py", line 892, in main
    run(args)
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/run.py", line 883, in run
    elastic_launch(
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 270, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-06-25_10:50:23
  host      : alex-System-Product-Name
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 70718)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
(GeneticTrading) alex@alex-System-Product-Name:/mnt/windows/GeneticTrading$ torchrun --nproc_per_node=4 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=12356 main.py --data-percentage 0.5 --max-rows 500000 --adaptive-iterations 10 --log-level INFO --nccl-timeout 7200000
W0625 10:59:44.318000 71913 site-packages/torch/distributed/run.py:766] 
W0625 10:59:44.318000 71913 site-packages/torch/distributed/run.py:766] *****************************************
W0625 10:59:44.318000 71913 site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0625 10:59:44.318000 71913 site-packages/torch/distributed/run.py:766] *****************************************
I0625 10:59:46.575000 71947 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 10:59:46 [INFO    ] [Rank-71947] STARTUP             : ================================================================================
2025-06-25 10:59:46 [INFO    ] [Rank-71947] STARTUP             : Training session started for rank 0
2025-06-25 10:59:46 [INFO    ] [Rank-71947] STARTUP             : Log file: logs/training_rank_0.log
2025-06-25 10:59:46 [INFO    ] [Rank-71947] STARTUP             : Process ID: 71947
2025-06-25 10:59:46 [INFO    ] [Rank-71947] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 10:59:46 [INFO    ] [Rank-71947] STARTUP             : ================================================================================
2025-06-25 10:59:46 [INFO    ] [Rank-71947] root                : NCCL_TIMEOUT = 7200000 ms
2025-06-25 10:59:46 [INFO    ] [Rank-71947] root                : Using 50.0% of available data
2025-06-25 10:59:46 [INFO    ] [Rank-71947] root                : Models will be saved to: ./models
2025-06-25 10:59:46 [INFO    ] [Rank-71947] root                : Rank 0/4 starting on cuda:0 (has_cudf=True)
2025-06-25 10:59:46 [INFO    ] [Rank-71947] root                : Data loading parameters: max_rows=500000, data_percentage=0.5
2025-06-25 10:59:46 [INFO    ] [Rank-71947] root                : Adjusted max_rows to 250000 based on data_percentage
2025-06-25 10:59:46 [INFO    ] [Rank-71947] root                : Parquet cache found; skipping preprocessing.
alex-System-Product-Name:71947:71947 [0] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:71947:71947 [0] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:71947:71947 [0] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:71947:71947 [0] NCCL INFO Comm config Blocking set to 1
I0625 10:59:46.722000 71948 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 10:59:46 [INFO    ] [Rank-71948] STARTUP             : ================================================================================
2025-06-25 10:59:46 [INFO    ] [Rank-71948] STARTUP             : Training session started for rank 1
2025-06-25 10:59:46 [INFO    ] [Rank-71948] STARTUP             : Log file: logs/training_rank_1.log
2025-06-25 10:59:46 [INFO    ] [Rank-71948] STARTUP             : Process ID: 71948
2025-06-25 10:59:46 [INFO    ] [Rank-71948] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 10:59:46 [INFO    ] [Rank-71948] STARTUP             : ================================================================================
2025-06-25 10:59:46 [INFO    ] [Rank-71948] root                : Rank 1/4 starting on cuda:1 (has_cudf=True)
2025-06-25 10:59:46 [INFO    ] [Rank-71948] root                : Data loading parameters: max_rows=500000, data_percentage=0.5
2025-06-25 10:59:46 [INFO    ] [Rank-71948] root                : Adjusted max_rows to 250000 based on data_percentage
alex-System-Product-Name:71947:72000 [0] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:71947:72000 [0] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:71947:72000 [0] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:71947:72000 [0] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:71947:72000 [0] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:71947:72000 [0] NCCL INFO Using network Socket
alex-System-Product-Name:71947:72000 [0] NCCL INFO ncclCommInitRankConfig comm 0x621600110370 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x58f78f511d7a8c02 - Init START
alex-System-Product-Name:71948:71948 [1] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:71948:71948 [1] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:71948:71948 [1] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:71948:71948 [1] NCCL INFO Comm config Blocking set to 1
I0625 10:59:46.734000 71950 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 10:59:46 [INFO    ] [Rank-71950] STARTUP             : ================================================================================
2025-06-25 10:59:46 [INFO    ] [Rank-71950] STARTUP             : Training session started for rank 3
2025-06-25 10:59:46 [INFO    ] [Rank-71950] STARTUP             : Log file: logs/training_rank_3.log
2025-06-25 10:59:46 [INFO    ] [Rank-71950] STARTUP             : Process ID: 71950
2025-06-25 10:59:46 [INFO    ] [Rank-71950] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 10:59:46 [INFO    ] [Rank-71950] STARTUP             : ================================================================================
2025-06-25 10:59:46 [INFO    ] [Rank-71950] root                : Rank 3/4 starting on cuda:3 (has_cudf=True)
2025-06-25 10:59:46 [INFO    ] [Rank-71950] root                : Data loading parameters: max_rows=500000, data_percentage=0.5
2025-06-25 10:59:46 [INFO    ] [Rank-71950] root                : Adjusted max_rows to 250000 based on data_percentage
I0625 10:59:46.735000 71949 site-packages/torch/distributed/distributed_c10d.py:432] Using backend config: {'cuda': 'nccl'}
2025-06-25 10:59:46 [INFO    ] [Rank-71949] STARTUP             : ================================================================================
2025-06-25 10:59:46 [INFO    ] [Rank-71949] STARTUP             : Training session started for rank 2
2025-06-25 10:59:46 [INFO    ] [Rank-71949] STARTUP             : Log file: logs/training_rank_2.log
2025-06-25 10:59:46 [INFO    ] [Rank-71949] STARTUP             : Process ID: 71949
2025-06-25 10:59:46 [INFO    ] [Rank-71949] STARTUP             : Working directory: /mnt/windows/GeneticTrading
2025-06-25 10:59:46 [INFO    ] [Rank-71949] STARTUP             : ================================================================================
2025-06-25 10:59:46 [INFO    ] [Rank-71949] root                : Rank 2/4 starting on cuda:2 (has_cudf=True)
2025-06-25 10:59:46 [INFO    ] [Rank-71949] root                : Data loading parameters: max_rows=500000, data_percentage=0.5
2025-06-25 10:59:46 [INFO    ] [Rank-71949] root                : Adjusted max_rows to 250000 based on data_percentage
alex-System-Product-Name:71950:71950 [3] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:71950:71950 [3] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:71950:71950 [3] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:71949:71949 [2] NCCL INFO cudaDriverVersion 12020
alex-System-Product-Name:71949:71949 [2] NCCL INFO Bootstrap: Using wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:71949:71949 [2] NCCL INFO NCCL version 2.26.2+cuda12.2
alex-System-Product-Name:71950:71950 [3] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:71949:71949 [2] NCCL INFO Comm config Blocking set to 1
alex-System-Product-Name:71948:72007 [1] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:71948:72007 [1] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:71948:72007 [1] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:71948:72007 [1] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:71948:72007 [1] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:71948:72007 [1] NCCL INFO Using network Socket
alex-System-Product-Name:71948:72007 [1] NCCL INFO ncclCommInitRankConfig comm 0x5a7cb7bb22e0 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 5000 commId 0x58f78f511d7a8c02 - Init START
alex-System-Product-Name:71950:72012 [3] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:71950:72012 [3] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:71950:72012 [3] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:71950:72012 [3] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:71950:72012 [3] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:71950:72012 [3] NCCL INFO Using network Socket
alex-System-Product-Name:71950:72012 [3] NCCL INFO ncclCommInitRankConfig comm 0x5fb380180130 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 9000 commId 0x58f78f511d7a8c02 - Init START
alex-System-Product-Name:71947:72000 [0] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:71949:72013 [2] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
alex-System-Product-Name:71949:72013 [2] NCCL INFO NET/IB : No device found.
alex-System-Product-Name:71949:72013 [2] NCCL INFO NET/IB : Using [RO]; OOB wlp0s20f3:192.168.0.94<0>
alex-System-Product-Name:71949:72013 [2] NCCL INFO NET/Socket : Using [0]wlp0s20f3:192.168.0.94<0> [1]br-447583e7b32a:172.18.0.1<0> [2]br-81374c9c6e9c:172.19.0.1<0> [3]br-aaa630fe606a:172.20.0.1<0> [4]br-bc0f5ef31d4f:192.168.128.1<0>
alex-System-Product-Name:71949:72013 [2] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
alex-System-Product-Name:71949:72013 [2] NCCL INFO Using network Socket
alex-System-Product-Name:71949:72013 [2] NCCL INFO ncclCommInitRankConfig comm 0x5b8650a93ce0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 8000 commId 0x58f78f511d7a8c02 - Init START
alex-System-Product-Name:71949:72013 [2] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:71950:72012 [3] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:71948:72007 [1] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
alex-System-Product-Name:71950:72012 [3] NCCL INFO Bootstrap timings total 0.010956 (create 0.000012, send 0.000053, recv 0.000076, ring 0.000033, delay 0.000000)
alex-System-Product-Name:71948:72007 [1] NCCL INFO Bootstrap timings total 0.021918 (create 0.000014, send 0.000059, recv 0.021691, ring 0.000018, delay 0.000000)
alex-System-Product-Name:71949:72013 [2] NCCL INFO Bootstrap timings total 0.000313 (create 0.000010, send 0.000050, recv 0.000112, ring 0.000033, delay 0.000000)
alex-System-Product-Name:71947:72000 [0] NCCL INFO Bootstrap timings total 0.098771 (create 0.000012, send 0.000050, recv 0.076961, ring 0.002857, delay 0.000000)
alex-System-Product-Name:71950:72012 [3] NCCL INFO NVLS multicast support is not available on dev 3
alex-System-Product-Name:71948:72007 [1] NCCL INFO NVLS multicast support is not available on dev 1
alex-System-Product-Name:71949:72013 [2] NCCL INFO NVLS multicast support is not available on dev 2
alex-System-Product-Name:71947:72000 [0] NCCL INFO NVLS multicast support is not available on dev 0
alex-System-Product-Name:71947:72000 [0] NCCL INFO comm 0x621600110370 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
alex-System-Product-Name:71949:72013 [2] NCCL INFO comm 0x5b8650a93ce0 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
alex-System-Product-Name:71948:72007 [1] NCCL INFO comm 0x5a7cb7bb22e0 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
alex-System-Product-Name:71950:72012 [3] NCCL INFO comm 0x5fb380180130 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
alex-System-Product-Name:71947:72000 [0] NCCL INFO Channel 00/04 : 0 2 3 1
alex-System-Product-Name:71949:72013 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] -1/-1/-1->2->0 [2] 3/-1/-1->2->1 [3] -1/-1/-1->2->0
alex-System-Product-Name:71947:72000 [0] NCCL INFO Channel 01/04 : 0 1 3 2
alex-System-Product-Name:71948:72007 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 3/-1/-1->1->-1 [2] 2/-1/-1->1->0 [3] 3/-1/-1->1->-1
alex-System-Product-Name:71950:72012 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] 0/-1/-1->3->1 [2] -1/-1/-1->3->2 [3] 0/-1/-1->3->1
alex-System-Product-Name:71949:72013 [2] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:71947:72000 [0] NCCL INFO Channel 02/04 : 0 2 3 1
alex-System-Product-Name:71948:72007 [1] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:71950:72012 [3] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:71947:72000 [0] NCCL INFO Channel 03/04 : 0 1 3 2
alex-System-Product-Name:71947:72000 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 2/-1/-1->0->3 [2] 1/-1/-1->0->-1 [3] 2/-1/-1->0->3
alex-System-Product-Name:71947:72000 [0] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:71947:72000 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
alex-System-Product-Name:71947:72020 [0] NCCL INFO [Proxy Service] Device 0 CPU core 24
alex-System-Product-Name:71948:72022 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 17
alex-System-Product-Name:71948:72019 [1] NCCL INFO [Proxy Service] Device 1 CPU core 26
alex-System-Product-Name:71949:72018 [2] NCCL INFO [Proxy Service] Device 2 CPU core 24
alex-System-Product-Name:71950:72021 [3] NCCL INFO [Proxy Service] Device 3 CPU core 16
alex-System-Product-Name:71950:72023 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 17
alex-System-Product-Name:71949:72024 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 29
alex-System-Product-Name:71947:72025 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 31
alex-System-Product-Name:71949:72013 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:71949:72013 [2] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:71947:72000 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:71947:72000 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:71950:72012 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:71950:72012 [3] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:71948:72007 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:71948:72007 [1] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:71947:72000 [0] NCCL INFO CC Off, workFifoBytes 1048576
alex-System-Product-Name:71947:72000 [0] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:71948:72007 [1] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:71949:72013 [2] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:71947:72000 [0] NCCL INFO ncclCommInitRankConfig comm 0x621600110370 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x58f78f511d7a8c02 - Init COMPLETE
alex-System-Product-Name:71950:72012 [3] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:71948:72007 [1] NCCL INFO ncclCommInitRankConfig comm 0x5a7cb7bb22e0 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 5000 commId 0x58f78f511d7a8c02 - Init COMPLETE
alex-System-Product-Name:71949:72013 [2] NCCL INFO ncclCommInitRankConfig comm 0x5b8650a93ce0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 8000 commId 0x58f78f511d7a8c02 - Init COMPLETE
alex-System-Product-Name:71950:72012 [3] NCCL INFO ncclCommInitRankConfig comm 0x5fb380180130 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 9000 commId 0x58f78f511d7a8c02 - Init COMPLETE
alex-System-Product-Name:71947:72000 [0] NCCL INFO Init timings - ncclCommInitRankConfig: rank 0 nranks 4 total 0.24 (kernels 0.12, alloc 0.00, bootstrap 0.10, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:71948:72007 [1] NCCL INFO Init timings - ncclCommInitRankConfig: rank 1 nranks 4 total 0.11 (kernels 0.07, alloc 0.00, bootstrap 0.02, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:71949:72013 [2] NCCL INFO Init timings - ncclCommInitRankConfig: rank 2 nranks 4 total 0.10 (kernels 0.08, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:71950:72012 [3] NCCL INFO Init timings - ncclCommInitRankConfig: rank 3 nranks 4 total 0.10 (kernels 0.07, alloc 0.00, bootstrap 0.01, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:71947:72026 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
alex-System-Product-Name:71949:72028 [2] NCCL INFO Channel 00 : 2[2] -> 3[3] via SHM/direct/direct
alex-System-Product-Name:71947:72026 [0] NCCL INFO Channel 03 : 0[0] -> 1[1] via SHM/direct/direct
alex-System-Product-Name:71949:72028 [2] NCCL INFO Channel 02 : 2[2] -> 3[3] via SHM/direct/direct
alex-System-Product-Name:71948:72029 [1] NCCL INFO Channel 01/0 : 1[1] -> 3[3] via P2P/CUMEM
alex-System-Product-Name:71948:72029 [1] NCCL INFO Channel 03/0 : 1[1] -> 3[3] via P2P/CUMEM
alex-System-Product-Name:71947:72026 [0] NCCL INFO Channel 00/0 : 0[0] -> 2[2] via P2P/CUMEM
alex-System-Product-Name:71947:72026 [0] NCCL INFO Channel 02/0 : 0[0] -> 2[2] via P2P/CUMEM
alex-System-Product-Name:71949:72028 [2] NCCL INFO Channel 01/0 : 2[2] -> 0[0] via P2P/CUMEM
alex-System-Product-Name:71950:72027 [3] NCCL INFO Channel 00/0 : 3[3] -> 1[1] via P2P/CUMEM
alex-System-Product-Name:71949:72028 [2] NCCL INFO Channel 03/0 : 2[2] -> 0[0] via P2P/CUMEM
alex-System-Product-Name:71950:72027 [3] NCCL INFO Channel 02/0 : 3[3] -> 1[1] via P2P/CUMEM
alex-System-Product-Name:71948:72029 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
alex-System-Product-Name:71950:72027 [3] NCCL INFO Channel 01 : 3[3] -> 2[2] via SHM/direct/direct
alex-System-Product-Name:71948:72029 [1] NCCL INFO Channel 02 : 1[1] -> 0[0] via SHM/direct/direct
alex-System-Product-Name:71950:72027 [3] NCCL INFO Channel 03 : 3[3] -> 2[2] via SHM/direct/direct
alex-System-Product-Name:71948:72029 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:71947:72026 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:71950:72027 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:71949:72028 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2025-06-25 10:59:47 [INFO    ] [Rank-71947] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 10:59:47 [INFO    ] [Rank-71947] root                : Rank 0: Sampled 100000 train rows from 4311800 total
2025-06-25 10:59:47 [INFO    ] [Rank-71947] root                : Rank 0: Sampled 20000 test rows from 1077950 total
2025-06-25 10:59:47 [INFO    ] [Rank-71947] numba.cuda.cudadrv.driver: init
2025-06-25 10:59:47 [INFO    ] [Rank-71950] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 10:59:47 [INFO    ] [Rank-71948] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 10:59:47 [INFO    ] [Rank-71950] root                : Rank 3: Sampled 100000 train rows from 4311800 total
2025-06-25 10:59:47 [INFO    ] [Rank-71950] root                : Rank 3: Sampled 20000 test rows from 1077950 total
2025-06-25 10:59:47 [INFO    ] [Rank-71950] numba.cuda.cudadrv.driver: init
2025-06-25 10:59:47 [INFO    ] [Rank-71948] root                : Rank 1: Sampled 100000 train rows from 4311800 total
2025-06-25 10:59:47 [INFO    ] [Rank-71948] root                : Rank 1: Sampled 20000 test rows from 1077950 total
2025-06-25 10:59:47 [INFO    ] [Rank-71948] numba.cuda.cudadrv.driver: init
2025-06-25 10:59:47 [INFO    ] [Rank-71949] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 10:59:47 [INFO    ] [Rank-71949] root                : Rank 2: Sampled 100000 train rows from 4311800 total
2025-06-25 10:59:47 [INFO    ] [Rank-71949] root                : Rank 2: Sampled 20000 test rows from 1077950 total
2025-06-25 10:59:47 [INFO    ] [Rank-71949] numba.cuda.cudadrv.driver: init
2025-06-25 10:59:48 [INFO    ] [Rank-71947] email_notifications : Email notifications configured for ali.aloraibi@outlook.com
2025-06-25 10:59:48 [INFO    ] [Rank-71947] email_notifications : Notifications will be sent every 6 hours
2025-06-25 10:59:48 [INFO    ] [Rank-71947] email_notifications : No training metrics available for progress update
2025-06-25 10:59:48 [INFO    ] [Rank-71947] email_notifications : Training monitoring started
2025-06-25 10:59:48 [INFO    ] [Rank-71947] root                : Email notifications enabled - reports every 6 hours
2025-06-25 10:59:49 [INFO    ] [Rank-71947] adaptive_trainer    : Removed old TensorBoard run: ./runs/ga_experiment
2025-06-25 10:59:49 [INFO    ] [Rank-71947] adaptive_trainer    : Starting adaptive training
2025-06-25 10:59:49 [INFO    ] [Rank-71947] adaptive_trainer    : 
=== Adaptive Training Iteration 1/10 ===
2025-06-25 10:59:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 10:59:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 10:59:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 10:59:54 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 15573 profits, total=3848583368230.8164
2025-06-25 10:59:54 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 10:59:54 [INFO    ] [Rank-71947] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 10:59:54 [INFO    ] [Rank-71947] adaptive_trainer    : Stagnation: 0, Poor performance: 0
2025-06-25 10:59:54 [INFO    ] [Rank-71947] adaptive_trainer    : Method: GA, Entropy: 1.0986
2025-06-25 10:59:54 [INFO    ] [Rank-71947] adaptive_trainer    : Switching to PPO due to: good_performance_refinement, ga_solution_refinement
2025-06-25 10:59:54 [INFO    ] [Rank-71947] adaptive_trainer    : Switching from GA to PPO
2025-06-25 10:59:54 [INFO    ] [Rank-71947] adaptive_trainer    : Starting PPO phase: 150 updates
2025-06-25 10:59:54 [INFO    ] [Rank-71947] policy_gradient_methods: Loaded model from models/ppo_models/adaptive_ppo_model.pth
[rank0]:I0625 10:59:54.335000 71947 site-packages/torch/distributed/nn/jit/instantiator.py:24] Created a temporary directory at /tmp/tmpstbzxhcu
[rank0]:I0625 10:59:54.336000 71947 site-packages/torch/distributed/nn/jit/instantiator.py:75] Writing /tmp/tmpstbzxhcu/_remote_module_non_scriptable.py
Removed old TensorBoard run: ./runs/ppo_rank_0
2025-06-25 10:59:54 [INFO    ] [Rank-71947] policy_gradient_methods: Loaded model from models/ppo_models/adaptive_ppo_model.pth
2025-06-25 10:59:58 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 10534 profits, total=1711795067753.3591
2025-06-25 10:59:58 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=130.9439, Sharpe=4.0000, MDD=5.0000
2025-06-25 11:00:49 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 1868 profits, total=59782912504.0275                                                                                                 
2025-06-25 11:00:49 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=92.6412, Sharpe=4.0000, MDD=5.0000
2025-06-25 11:00:49 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 50: Performance=0.4679, Entropy=1.0986
2025-06-25 11:01:46 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 15656 profits, total=3914551020437.1118                                                                                              
2025-06-25 11:01:46 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=7.1850
2025-06-25 11:01:46 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 100: Performance=0.7856, Entropy=1.0986
2025-06-25 11:02:43 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 12003 profits, total=2273899135194.1162                                                                                              
2025-06-25 11:02:43 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=138.1253, Sharpe=4.0000, MDD=5.0000
2025-06-25 11:02:43 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 150: Performance=0.6044, Entropy=1.0986
2025-06-25 11:02:43 [INFO    ] [Rank-71947] policy_gradient_methods: Saved model to models/ppo_models/adaptive_ppo_model.pth at 2025-06-25 11:02:43.311063
2025-06-25 11:02:45 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 7102 profits, total=3632455697001.9883
2025-06-25 11:02:45 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=162.7546, Sharpe=4.0000, MDD=5.0000
2025-06-25 11:02:45 [INFO    ] [Rank-71947] adaptive_trainer    : PPO phase completed with performance: 0.6783
2025-06-25 11:02:45 [INFO    ] [Rank-71947] adaptive_trainer    : 
=== Adaptive Training Iteration 2/10 ===
2025-06-25 11:02:48 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 9241 profits, total=6278308701138.6611
2025-06-25 11:02:48 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 11:02:48 [INFO    ] [Rank-71947] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 11:02:48 [INFO    ] [Rank-71947] adaptive_trainer    : Stagnation: 1, Poor performance: 0
2025-06-25 11:02:48 [INFO    ] [Rank-71947] adaptive_trainer    : Method: PPO, Entropy: 0.5881
2025-06-25 11:02:48 [INFO    ] [Rank-71947] adaptive_trainer    : Switching to GA due to: exploration_phase
2025-06-25 11:02:48 [INFO    ] [Rank-71947] adaptive_trainer    : Switching from PPO to GA
2025-06-25 11:02:48 [INFO    ] [Rank-71947] adaptive_trainer    : Starting GA phase: 20 generations, population 20
[GA] Loaded GA model from models/ga_models/adaptive_ga_model.pth
[GA] Loaded GA model from models/ga_models/adaptive_ga_model.pth                                                        
[GA gens]:   0%|                                                                                 | 0/10 [00:00<?, ?it/s]2025-06-25 11:04:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:04:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:04:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 11:09:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:09:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:09:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 11:14:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:14:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:14:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 11:19:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:19:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:19:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 11:24:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:24:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:24:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=1340931.8, max=7774680.1, stg=0:  10%|███▎                             | 1/10 [23:04<3:27:41, 1384.63s/it]2025-06-25 11:29:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:29:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:29:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 11:34:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:34:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:34:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=1539742.8, max=8361955.7, stg=0:  20%|██████▌                          | 2/10 [35:38<2:15:09, 1013.65s/it]2025-06-25 11:39:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:39:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:39:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 11:44:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:44:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:44:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 11:49:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:49:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:49:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=1862147.1, max=10096295.2, stg=0:  30%|█████████▉                       | 3/10 [48:10<1:44:18, 894.02s/it]2025-06-25 11:54:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:54:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:54:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 11:59:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 11:59:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 11:59:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA gens] avg=2075103.4, max=8758543.1, stg=0:  40%|████████████▊                   | 4/10 [1:01:03<1:24:37, 846.26s/it]2025-06-25 12:04:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:04:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:04:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 12:09:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:09:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:09:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 12:14:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:14:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:14:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA gens] avg=2679117.6, max=6729303.5, stg=1:  50%|████████████████                | 5/10 [1:12:06<1:05:01, 780.30s/it]2025-06-25 12:19:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:19:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:19:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 12:24:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:24:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:24:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=4859856.0, max=11427277.6, stg=2:  60%|███████████████████▊             | 6/10 [1:24:05<50:37, 759.27s/it]2025-06-25 12:29:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:29:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:29:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 12:34:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:34:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:34:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 12:39:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:39:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:39:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA gens] avg=5035428.1, max=9757235.3, stg=0:  70%|███████████████████████▊          | 7/10 [1:37:06<38:19, 766.51s/it]2025-06-25 12:44:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:44:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:44:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 12:49:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:49:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:49:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA gens] avg=5635365.5, max=10240975.0, stg=1:  80%|██████████████████████████▍      | 8/10 [1:50:05<25:41, 770.59s/it]2025-06-25 12:54:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:54:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:54:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 12:59:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 12:59:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 12:59:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:04:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:04:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:04:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA gens] avg=6140889.5, max=10293234.9, stg=2:  90%|█████████████████████████████▋   | 9/10 [2:02:09<12:35, 755.91s/it]2025-06-25 13:09:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:09:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:09:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:14:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:14:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:14:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:17:05 [INFO    ] [Rank-71947] adaptive_trainer    : GA phase completed with fitness: 11427277.6338        
2025-06-25 13:17:05 [INFO    ] [Rank-71947] adaptive_trainer    : 
=== Adaptive Training Iteration 3/10 ===
2025-06-25 13:17:08 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 8909 profits, total=2933734582709.2603
2025-06-25 13:17:08 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:17:08 [INFO    ] [Rank-71947] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 13:17:08 [INFO    ] [Rank-71947] adaptive_trainer    : Stagnation: 2, Poor performance: 0
2025-06-25 13:17:08 [INFO    ] [Rank-71947] adaptive_trainer    : Method: GA, Entropy: 0.5759
2025-06-25 13:17:08 [INFO    ] [Rank-71947] adaptive_trainer    : Switching to PPO due to: good_performance_refinement, ga_solution_refinement
2025-06-25 13:17:08 [INFO    ] [Rank-71947] adaptive_trainer    : Switching from GA to PPO
2025-06-25 13:17:08 [INFO    ] [Rank-71947] adaptive_trainer    : Starting PPO phase: 150 updates
2025-06-25 13:17:08 [INFO    ] [Rank-71947] policy_gradient_methods: Loaded model from models/ppo_models/adaptive_ppo_model.pth
2025-06-25 13:17:09 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 3234 profits, total=360903779442.8417
2025-06-25 13:17:09 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:18:05 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 5246 profits, total=927316666604.8146                                                                                                
2025-06-25 13:18:05 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:18:05 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 50: Performance=0.7900, Entropy=0.4291
2025-06-25 13:18:56 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 2391 profits, total=204934984404.1562                                                                                                
2025-06-25 13:18:56 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:18:56 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 100: Performance=0.7900, Entropy=0.5026
2025-06-25 13:19:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training                                                                                                         
2025-06-25 13:19:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:19:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:19:52 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 18634 profits, total=13029251027834.3262
2025-06-25 13:19:52 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:19:52 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 150: Performance=0.7900, Entropy=0.3587
2025-06-25 13:19:52 [WARNING ] [Rank-71947] adaptive_trainer    : PPO early stopping due to lack of improvement (patience: 3)
2025-06-25 13:19:52 [INFO    ] [Rank-71947] policy_gradient_methods: Saved model to models/ppo_models/adaptive_ppo_model.pth at 2025-06-25 13:19:52.733794
2025-06-25 13:19:52 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 353 profits, total=8554819095.0479
2025-06-25 13:19:52 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:19:52 [INFO    ] [Rank-71947] adaptive_trainer    : PPO phase completed with performance: 0.7900
2025-06-25 13:19:52 [INFO    ] [Rank-71947] adaptive_trainer    : 
=== Adaptive Training Iteration 4/10 ===
2025-06-25 13:19:54 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 5816 profits, total=2450853901345.2256
2025-06-25 13:19:54 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:19:54 [INFO    ] [Rank-71947] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 13:19:54 [INFO    ] [Rank-71947] adaptive_trainer    : Stagnation: 3, Poor performance: 0
2025-06-25 13:19:54 [INFO    ] [Rank-71947] adaptive_trainer    : Method: PPO, Entropy: 0.8138
2025-06-25 13:19:54 [INFO    ] [Rank-71947] adaptive_trainer    : Starting PPO phase: 100 updates
2025-06-25 13:19:54 [INFO    ] [Rank-71947] policy_gradient_methods: Loaded model from models/ppo_models/adaptive_ppo_model.pth
2025-06-25 13:20:00 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 15999 profits, total=18736399757144.9414
2025-06-25 13:20:00 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:20:51 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 631 profits, total=29530221633.4564                                                                                                  
2025-06-25 13:20:51 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:20:51 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 50: Performance=0.7900, Entropy=0.5570
2025-06-25 13:21:46 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 13568 profits, total=13071292571262.9141                                                                                             
2025-06-25 13:21:46 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:21:46 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 100: Performance=0.7900, Entropy=0.3636
2025-06-25 13:21:46 [INFO    ] [Rank-71947] policy_gradient_methods: Saved model to models/ppo_models/adaptive_ppo_model.pth at 2025-06-25 13:21:46.640600
2025-06-25 13:21:50 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 13202 profits, total=12247990835926.7422
2025-06-25 13:21:50 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:21:50 [INFO    ] [Rank-71947] adaptive_trainer    : PPO phase completed with performance: 0.7900
2025-06-25 13:21:50 [INFO    ] [Rank-71947] adaptive_trainer    : 
=== Adaptive Training Iteration 5/10 ===
2025-06-25 13:21:52 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 3745 profits, total=1008144263791.4608
2025-06-25 13:21:52 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:21:52 [INFO    ] [Rank-71947] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 13:21:52 [INFO    ] [Rank-71947] adaptive_trainer    : Stagnation: 4, Poor performance: 0
2025-06-25 13:21:52 [INFO    ] [Rank-71947] adaptive_trainer    : Method: PPO, Entropy: 0.5360
2025-06-25 13:21:52 [INFO    ] [Rank-71947] adaptive_trainer    : Starting PPO phase: 100 updates
2025-06-25 13:21:52 [INFO    ] [Rank-71947] policy_gradient_methods: Loaded model from models/ppo_models/adaptive_ppo_model.pth
2025-06-25 13:21:52 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 2255 profits, total=359889837654.1990
2025-06-25 13:21:52 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:22:49 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 15232 profits, total=16213414996721.8906                                                                                             
2025-06-25 13:22:49 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:22:49 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 50: Performance=0.7900, Entropy=0.5720
2025-06-25 13:23:40 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 176 profits, total=2862488961.0159                                                                                                            
2025-06-25 13:23:40 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=111.4203, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:23:40 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 100: Performance=0.5243, Entropy=0.5864
2025-06-25 13:23:40 [INFO    ] [Rank-71947] policy_gradient_methods: Saved model to models/ppo_models/adaptive_ppo_model.pth at 2025-06-25 13:23:40.768619
2025-06-25 13:23:46 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 16559 profits, total=22353683912265.4414
2025-06-25 13:23:46 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:23:46 [INFO    ] [Rank-71947] adaptive_trainer    : PPO phase completed with performance: 0.7900
2025-06-25 13:23:46 [INFO    ] [Rank-71947] adaptive_trainer    : 
=== Adaptive Training Iteration 6/10 ===
2025-06-25 13:23:48 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 4557 profits, total=1654071960424.0176
2025-06-25 13:23:48 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 13:23:48 [INFO    ] [Rank-71947] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 13:23:48 [INFO    ] [Rank-71947] adaptive_trainer    : Stagnation: 5, Poor performance: 0
2025-06-25 13:23:48 [INFO    ] [Rank-71947] adaptive_trainer    : Method: PPO, Entropy: 0.5129
2025-06-25 13:23:48 [INFO    ] [Rank-71947] adaptive_trainer    : Switching to GA due to: performance_stagnation
2025-06-25 13:23:48 [INFO    ] [Rank-71947] adaptive_trainer    : Switching from PPO to GA
2025-06-25 13:23:48 [INFO    ] [Rank-71947] adaptive_trainer    : Starting GA phase: 20 generations, population 20
[GA] Loaded GA model from models/ga_models/adaptive_ga_model.pth
[GA] Loaded GA model from models/ga_models/adaptive_ga_model.pth                                                        
[GA gens]:   0%|                                                                                 | 0/10 [00:00<?, ?it/s]2025-06-25 13:24:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:24:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:24:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:29:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:29:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:29:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:34:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:34:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:34:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:39:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:39:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:39:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:44:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:44:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:44:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=4337868.9, max=9531945.4, stg=0:  10%|███▎                             | 1/10 [25:13<3:47:04, 1513.82s/it]2025-06-25 13:49:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:49:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:49:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:54:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:54:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:54:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 13:59:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 13:59:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 13:59:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=1510212.0, max=10661640.5, stg=0:  20%|██████▍                         | 2/10 [36:21<2:15:29, 1016.14s/it]2025-06-25 14:04:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:04:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:04:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 14:09:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:09:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:09:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=2771884.6, max=12140320.2, stg=0:  30%|█████████▉                       | 3/10 [48:53<1:44:29, 895.64s/it]2025-06-25 14:14:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:14:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:14:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 14:19:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:19:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:19:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 14:24:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:24:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:24:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=1432462.5, max=12848502.7, stg=0:  40%|████████████▍                  | 4/10 [1:01:59<1:25:14, 852.40s/it]2025-06-25 14:29:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:29:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:29:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 14:34:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:34:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:34:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA gens] avg=2848924.8, max=12227007.8, stg=0:  50%|███████████████▌               | 5/10 [1:13:26<1:06:02, 792.45s/it]2025-06-25 14:39:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:39:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:39:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 14:44:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:44:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:44:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=4525151.3, max=13246475.1, stg=1:  60%|███████████████████▊             | 6/10 [1:25:56<51:52, 778.19s/it]2025-06-25 14:49:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:49:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:49:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 14:54:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:54:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:54:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 14:59:49 [INFO    ] [Rank-71950] root                : Rank 3 heartbeat - waiting for adaptive training
2025-06-25 14:59:49 [INFO    ] [Rank-71948] root                : Rank 1 heartbeat - waiting for adaptive training
2025-06-25 14:59:49 [INFO    ] [Rank-71949] root                : Rank 2 heartbeat - waiting for adaptive training
2025-06-25 14:59:54 [WARNING ] [Rank-71950] root                : Rank 3 timeout - exiting after 4 hours
2025-06-25 14:59:54 [WARNING ] [Rank-71948] root                : Rank 1 timeout - exiting after 4 hours
2025-06-25 14:59:54 [WARNING ] [Rank-71949] root                : Rank 2 timeout - exiting after 4 hours
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
2025-06-25 15:39:55 [INFO    ] [Rank-71947] adaptive_trainer    : GA phase completed with fitness: 15551395.1647        
2025-06-25 15:39:55 [INFO    ] [Rank-71947] adaptive_trainer    : 
=== Adaptive Training Iteration 7/10 ===
2025-06-25 15:40:01 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 18951 profits, total=19846844285964.9688
2025-06-25 15:40:01 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 15:40:01 [INFO    ] [Rank-71947] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 15:40:01 [INFO    ] [Rank-71947] adaptive_trainer    : Stagnation: 6, Poor performance: 0
2025-06-25 15:40:01 [INFO    ] [Rank-71947] adaptive_trainer    : Method: GA, Entropy: 0.6459
2025-06-25 15:40:01 [INFO    ] [Rank-71947] adaptive_trainer    : Switching to PPO due to: good_performance_refinement
2025-06-25 15:40:01 [INFO    ] [Rank-71947] adaptive_trainer    : Switching from GA to PPO
2025-06-25 15:40:01 [INFO    ] [Rank-71947] adaptive_trainer    : Starting PPO phase: 150 updates
2025-06-25 15:40:01 [INFO    ] [Rank-71947] policy_gradient_methods: Loaded model from models/ppo_models/adaptive_ppo_model.pth
2025-06-25 15:40:07 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 15951 profits, total=13771328210509.3379
2025-06-25 15:40:07 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=189.3575, Sharpe=4.0000, MDD=100.0000
2025-06-25 15:41:01 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 7460 profits, total=2985382354050.8486                                                                                                        
2025-06-25 15:41:01 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 15:41:01 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 50: Performance=0.7900, Entropy=0.7426
2025-06-25 15:41:56 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 7375 profits, total=2897544569639.4180                                                                                                        
2025-06-25 15:41:56 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=42.3000
2025-06-25 15:41:56 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 100: Performance=0.7154, Entropy=0.7152
2025-06-25 15:42:55 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 19465 profits, total=20990948174458.3008                                                                                                      
2025-06-25 15:42:55 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 15:42:55 [INFO    ] [Rank-71947] adaptive_trainer    : PPO Update 150: Performance=0.7900, Entropy=0.9071
2025-06-25 15:42:55 [INFO    ] [Rank-71947] policy_gradient_methods: Saved model to models/ppo_models/adaptive_ppo_model.pth at 2025-06-25 15:42:55.763251
2025-06-25 15:42:58 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 9131 profits, total=6554273095621.7129
2025-06-25 15:42:58 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 15:42:58 [INFO    ] [Rank-71947] adaptive_trainer    : PPO phase completed with performance: 0.7900
2025-06-25 15:42:58 [INFO    ] [Rank-71947] adaptive_trainer    : 
=== Adaptive Training Iteration 8/10 ===
2025-06-25 15:43:03 [INFO    ] [Rank-71947] adaptive_trainer    : Evaluation results: 13033 profits, total=13056468152634.1445
2025-06-25 15:43:03 [INFO    ] [Rank-71947] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 15:43:03 [INFO    ] [Rank-71947] adaptive_trainer    : Current performance: 0.7900 (best: 0.7900)
2025-06-25 15:43:03 [INFO    ] [Rank-71947] adaptive_trainer    : Stagnation: 7, Poor performance: 0
2025-06-25 15:43:03 [INFO    ] [Rank-71947] adaptive_trainer    : Method: PPO, Entropy: 0.5938
2025-06-25 15:43:03 [INFO    ] [Rank-71947] adaptive_trainer    : Switching to GA due to: performance_stagnation
2025-06-25 15:43:03 [INFO    ] [Rank-71947] adaptive_trainer    : Switching from PPO to GA
2025-06-25 15:43:03 [INFO    ] [Rank-71947] adaptive_trainer    : Starting GA phase: 20 generations, population 20
[GA] Loaded GA model from models/ga_models/adaptive_ga_model.pth
[GA] Loaded GA model from models/ga_models/adaptive_ga_model.pth                                                        
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA] Saved GA model to models/ga_models/adaptive_ga_model.pth                                                           
[GA gens] avg=2680163.4, max=7450576.4, stg=0:  50%|████████████████                | 5/10 [1:08:25<1:02:22, 748.46s/it]2025-06-25 16:59:48 [INFO    ] [Rank-71947] email_notifications : No training metrics available for progress update
[rank1]:[E625 16:59:54.513321061 ProcessGroupNCCL.cpp:632] [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=7200000) ran for 7200032 milliseconds before timing out.
[rank1]:[E625 16:59:54.513453225 ProcessGroupNCCL.cpp:2268] [PG ID 0 PG GUID 0(default_pg) Rank 1]  failure detected by watchdog at work sequence id: 2 PG status: last enqueued work: 2, last completed work: 1
[rank1]:[E625 16:59:54.517401485 ProcessGroupNCCL.cpp:667] Stack trace of the failed collective: 
#0 barrier from /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4622
#1 wrapper from /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/c10d_logger.py:81
#2 main from /mnt/windows/GeneticTrading/main.py:569
#3 <module> from /mnt/windows/GeneticTrading/main.py:578

[rank1]:[E625 16:59:54.517433101 ProcessGroupNCCL.cpp:2103] [PG ID 0 PG GUID 0(default_pg) Rank 1] First PG on this rank to signal dumping.
[rank3]:[E625 16:59:54.558732404 ProcessGroupNCCL.cpp:632] [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=7200000) ran for 7200094 milliseconds before timing out.
[rank3]:[E625 16:59:54.558851168 ProcessGroupNCCL.cpp:2268] [PG ID 0 PG GUID 0(default_pg) Rank 3]  failure detected by watchdog at work sequence id: 2 PG status: last enqueued work: 2, last completed work: 1
[rank3]:[E625 16:59:54.564777298 ProcessGroupNCCL.cpp:667] Stack trace of the failed collective: 
#0 barrier from /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4622
#1 wrapper from /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/c10d_logger.py:81
#2 main from /mnt/windows/GeneticTrading/main.py:569
#3 <module> from /mnt/windows/GeneticTrading/main.py:578

[rank3]:[E625 16:59:54.564801416 ProcessGroupNCCL.cpp:2103] [PG ID 0 PG GUID 0(default_pg) Rank 3] First PG on this rank to signal dumping.
[rank2]:[E625 16:59:54.666199345 ProcessGroupNCCL.cpp:632] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=7200000) ran for 7200069 milliseconds before timing out.
[rank2]:[E625 16:59:54.666315847 ProcessGroupNCCL.cpp:2268] [PG ID 0 PG GUID 0(default_pg) Rank 2]  failure detected by watchdog at work sequence id: 2 PG status: last enqueued work: 2, last completed work: 1
[rank2]:[E625 16:59:54.672247944 ProcessGroupNCCL.cpp:667] Stack trace of the failed collective: 
#0 barrier from /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4622
#1 wrapper from /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/c10d_logger.py:81
#2 main from /mnt/windows/GeneticTrading/main.py:569
#3 <module> from /mnt/windows/GeneticTrading/main.py:578

[rank2]:[E625 16:59:54.672273709 ProcessGroupNCCL.cpp:2103] [PG ID 0 PG GUID 0(default_pg) Rank 2] First PG on this rank to signal dumping.
[rank0]:[E625 16:59:55.404565198 ProcessGroupNCCL.cpp:1682] [PG ID 0 PG GUID 0(default_pg) Rank 0] Observed flight recorder dump signal from another rank via TCPStore.
[rank0]:[E625 16:59:55.404856442 ProcessGroupNCCL.cpp:1743] [PG ID 0 PG GUID 0(default_pg) Rank 0] Received a dump signal due to a collective timeout from  rank 2 and we will try our best to dump the debug info. Last enqueued NCCL work: 1, last completed NCCL work: 1.This is most likely caused by incorrect usages of collectives, e.g., wrong sizes used across ranks, the order of collectives is not same for all ranks or the scheduled collective, for some reason, didn't run. Additionally, this can be caused by GIL deadlock or other reasons such as network errors or bugs in the communications library (e.g. NCCL), etc. 
[rank0]:[E625 16:59:55.405028807 ProcessGroupNCCL.cpp:1533] [PG ID 0 PG GUID 0(default_pg) Rank 0] ProcessGroupNCCL preparing to dump debug info. Include stack trace: 1
[rank2]:[E625 16:59:55.431812474 ProcessGroupNCCL.cpp:1743] [PG ID 0 PG GUID 0(default_pg) Rank 2] Received a dump signal due to a collective timeout from this local rank and we will try our best to dump the debug info. Last enqueued NCCL work: 2, last completed NCCL work: 1.This is most likely caused by incorrect usages of collectives, e.g., wrong sizes used across ranks, the order of collectives is not same for all ranks or the scheduled collective, for some reason, didn't run. Additionally, this can be caused by GIL deadlock or other reasons such as network errors or bugs in the communications library (e.g. NCCL), etc. 
[rank2]:[E625 16:59:55.431922908 ProcessGroupNCCL.cpp:1533] [PG ID 0 PG GUID 0(default_pg) Rank 2] ProcessGroupNCCL preparing to dump debug info. Include stack trace: 1
alex-System-Product-Name:71949:99793 [2] NCCL INFO misc/socket.cc:64 -> 3
alex-System-Product-Name:71949:99793 [2] NCCL INFO misc/socket.cc:80 -> 3
alex-System-Product-Name:71949:99793 [2] NCCL INFO misc/socket.cc:829 -> 3
alex-System-Product-Name:71949:99793 [2] NCCL INFO misc/socket.cc:64 -> 3
alex-System-Product-Name:71949:99793 [2] NCCL INFO misc/socket.cc:80 -> 3
alex-System-Product-Name:71949:99793 [2] NCCL INFO misc/socket.cc:829 -> 3
alex-System-Product-Name:71949:72018 [2] NCCL INFO misc/socket.cc:881 -> 3
[rank1]:[E625 16:59:55.465895492 ProcessGroupNCCL.cpp:1743] [PG ID 0 PG GUID 0(default_pg) Rank 1] Received a dump signal due to a collective timeout from this local rank and we will try our best to dump the debug info. Last enqueued NCCL work: 2, last completed NCCL work: 1.This is most likely caused by incorrect usages of collectives, e.g., wrong sizes used across ranks, the order of collectives is not same for all ranks or the scheduled collective, for some reason, didn't run. Additionally, this can be caused by GIL deadlock or other reasons such as network errors or bugs in the communications library (e.g. NCCL), etc. 
[rank1]:[E625 16:59:55.466059786 ProcessGroupNCCL.cpp:1533] [PG ID 0 PG GUID 0(default_pg) Rank 1] ProcessGroupNCCL preparing to dump debug info. Include stack trace: 1
alex-System-Product-Name:71948:99798 [1] NCCL INFO comm 0x5a7cb7bb22e0 rank 1 nranks 4 cudaDev 1 busId 5000 - Abort COMPLETE
[rank1]:[E625 16:59:55.468857596 ProcessGroupNCCL.cpp:684] [Rank 1] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank1]:[E625 16:59:55.468862768 ProcessGroupNCCL.cpp:698] [Rank 1] To avoid data inconsistency, we are taking the entire process down.
[rank1]:[E625 16:59:55.469553098 ProcessGroupNCCL.cpp:1896] [PG ID 0 PG GUID 0(default_pg) Rank 1] Process group watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=7200000) ran for 7200032 milliseconds before timing out.
Exception raised from checkTimeout at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:635 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x773ea15785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x23d (0x773e475e2a1d in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0xc80 (0x773e475e47a0 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x773e475e5ead in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd3b6d (0x773e372f1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #5: <unknown function> + 0x94ac3 (0x773ea2c94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x773ea2d26850 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 1] Process group watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=7200000) ran for 7200032 milliseconds before timing out.
Exception raised from checkTimeout at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:635 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x773ea15785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x23d (0x773e475e2a1d in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0xc80 (0x773e475e47a0 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x773e475e5ead in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd3b6d (0x773e372f1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #5: <unknown function> + 0x94ac3 (0x773ea2c94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x773ea2d26850 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1902 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x773ea15785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x11b4a6e (0x773e475b4a6e in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xe07bed (0x773e47207bed in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: <unknown function> + 0xd3b6d (0x773e372f1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #4: <unknown function> + 0x94ac3 (0x773ea2c94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #5: <unknown function> + 0x126850 (0x773ea2d26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank3]:[E625 16:59:55.484078715 ProcessGroupNCCL.cpp:1743] [PG ID 0 PG GUID 0(default_pg) Rank 3] Received a dump signal due to a collective timeout from this local rank and we will try our best to dump the debug info. Last enqueued NCCL work: 2, last completed NCCL work: 1.This is most likely caused by incorrect usages of collectives, e.g., wrong sizes used across ranks, the order of collectives is not same for all ranks or the scheduled collective, for some reason, didn't run. Additionally, this can be caused by GIL deadlock or other reasons such as network errors or bugs in the communications library (e.g. NCCL), etc. 
[rank3]:[E625 16:59:55.484164261 ProcessGroupNCCL.cpp:1533] [PG ID 0 PG GUID 0(default_pg) Rank 3] ProcessGroupNCCL preparing to dump debug info. Include stack trace: 1
alex-System-Product-Name:71950:99802 [3] NCCL INFO comm 0x5fb380180130 rank 3 nranks 4 cudaDev 3 busId 9000 - Abort COMPLETE
[rank3]:[E625 16:59:55.544919099 ProcessGroupNCCL.cpp:684] [Rank 3] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank3]:[E625 16:59:55.544928793 ProcessGroupNCCL.cpp:698] [Rank 3] To avoid data inconsistency, we are taking the entire process down.
[rank3]:[E625 16:59:55.545640056 ProcessGroupNCCL.cpp:1896] [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=7200000) ran for 7200094 milliseconds before timing out.
Exception raised from checkTimeout at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:635 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x78f0e8b785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x23d (0x78f08e7e2a1d in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0xc80 (0x78f08e7e47a0 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x78f08e7e5ead in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd3b6d (0x78f0e86f1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #5: <unknown function> + 0x94ac3 (0x78f0e9e94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x78f0e9f26850 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=2, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=7200000) ran for 7200094 milliseconds before timing out.
Exception raised from checkTimeout at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:635 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x78f0e8b785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x23d (0x78f08e7e2a1d in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0xc80 (0x78f08e7e47a0 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x78f08e7e5ead in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd3b6d (0x78f0e86f1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #5: <unknown function> + 0x94ac3 (0x78f0e9e94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126850 (0x78f0e9f26850 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1902 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x78f0e8b785e8 in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x11b4a6e (0x78f08e7b4a6e in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xe07bed (0x78f08e407bed in /home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #3: <unknown function> + 0xd3b6d (0x78f0e86f1b6d in /home/alex/miniconda3/envs/GeneticTrading/bin/../lib/libstdc++.so.6)
frame #4: <unknown function> + 0x94ac3 (0x78f0e9e94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #5: <unknown function> + 0x126850 (0x78f0e9f26850 in /lib/x86_64-linux-gnu/libc.so.6)

W0625 16:59:55.614000 71913 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 71947 closing signal SIGTERM
W0625 16:59:55.615000 71913 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 71949 closing signal SIGTERM
W0625 16:59:55.615000 71913 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 71950 closing signal SIGTERM
/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/multiprocessing/resource_tracker.py:255: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
E0625 16:59:55.779000 71913 site-packages/torch/distributed/elastic/multiprocessing/api.py:874] failed (exitcode: -6) local_rank: 1 (pid: 71948) of binary: /home/alex/miniconda3/envs/GeneticTrading/bin/python3.12
Traceback (most recent call last):
  File "/home/alex/miniconda3/envs/GeneticTrading/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/run.py", line 892, in main
    run(args)
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/run.py", line 883, in run
    elastic_launch(
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alex/miniconda3/envs/GeneticTrading/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 270, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
======================================================
main.py FAILED
------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-06-25_16:59:55
  host      : alex-System-Product-Name
  rank      : 1 (local_rank: 1)
  exitcode  : -6 (pid: 71948)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 71948
======================================================
(GeneticTrading) alex@alex-System-Product-Name:/mnt/windows/GeneticTrading$ 
