alex-System-Product-Name:34340:34437 [1] NCCL INFO NVLS multicast support is not available on dev 1
alex-System-Product-Name:34342:34438 [3] NCCL INFO NVLS multicast support is not available on dev 3
alex-System-Product-Name:34339:34435 [0] NCCL INFO NVLS multicast support is not available on dev 0
alex-System-Product-Name:34342:34438 [3] NCCL INFO comm 0x63ca6e50cb40 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
alex-System-Product-Name:34340:34437 [1] NCCL INFO comm 0x5ba48b16e040 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
alex-System-Product-Name:34341:34436 [2] NCCL INFO comm 0x57babded75f0 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
alex-System-Product-Name:34339:34435 [0] NCCL INFO comm 0x632e087fc550 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
alex-System-Product-Name:34342:34438 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] 0/-1/-1->3->1 [2] -1/-1/-1->3->2 [3] 0/-1/-1->3->1
alex-System-Product-Name:34340:34437 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 3/-1/-1->1->-1 [2] 2/-1/-1->1->0 [3] 3/-1/-1->1->-1
alex-System-Product-Name:34339:34435 [0] NCCL INFO Channel 00/04 : 0 2 3 1
alex-System-Product-Name:34341:34436 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] -1/-1/-1->2->0 [2] 3/-1/-1->2->1 [3] -1/-1/-1->2->0
alex-System-Product-Name:34342:34438 [3] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:34340:34437 [1] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:34339:34435 [0] NCCL INFO Channel 01/04 : 0 1 3 2
alex-System-Product-Name:34341:34436 [2] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:34339:34435 [0] NCCL INFO Channel 02/04 : 0 2 3 1
alex-System-Product-Name:34339:34435 [0] NCCL INFO Channel 03/04 : 0 1 3 2
alex-System-Product-Name:34339:34435 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 2/-1/-1->0->3 [2] 1/-1/-1->0->-1 [3] 2/-1/-1->0->3
alex-System-Product-Name:34339:34435 [0] NCCL INFO P2P Chunksize set to 131072
alex-System-Product-Name:34339:34435 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
alex-System-Product-Name:34339:34444 [0] NCCL INFO [Proxy Service] Device 0 CPU core 22
alex-System-Product-Name:34339:34450 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 21
alex-System-Product-Name:34342:34443 [3] NCCL INFO [Proxy Service] Device 3 CPU core 18
alex-System-Product-Name:34341:34445 [2] NCCL INFO [Proxy Service] Device 2 CPU core 19
alex-System-Product-Name:34340:34446 [1] NCCL INFO [Proxy Service] Device 1 CPU core 29
alex-System-Product-Name:34340:34449 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 28
alex-System-Product-Name:34341:34448 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 24
alex-System-Product-Name:34342:34447 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 27
alex-System-Product-Name:34340:34437 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:34340:34437 [1] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:34342:34438 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:34342:34438 [3] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:34341:34436 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:34341:34436 [2] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:34339:34435 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
alex-System-Product-Name:34339:34435 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
alex-System-Product-Name:34339:34435 [0] NCCL INFO CC Off, workFifoBytes 1048576
alex-System-Product-Name:34341:34436 [2] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:34339:34435 [0] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:34340:34437 [1] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:34342:34438 [3] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
alex-System-Product-Name:34341:34436 [2] NCCL INFO ncclCommInitRankConfig comm 0x57babded75f0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 8000 commId 0xbd21b87118f2c692 - Init COMPLETE
alex-System-Product-Name:34339:34435 [0] NCCL INFO ncclCommInitRankConfig comm 0x632e087fc550 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0xbd21b87118f2c692 - Init COMPLETE
alex-System-Product-Name:34340:34437 [1] NCCL INFO ncclCommInitRankConfig comm 0x5ba48b16e040 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 5000 commId 0xbd21b87118f2c692 - Init COMPLETE
alex-System-Product-Name:34342:34438 [3] NCCL INFO ncclCommInitRankConfig comm 0x63ca6e50cb40 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 9000 commId 0xbd21b87118f2c692 - Init COMPLETE
alex-System-Product-Name:34341:34436 [2] NCCL INFO Init timings - ncclCommInitRankConfig: rank 2 nranks 4 total 0.10 (kernels 0.08, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:34339:34435 [0] NCCL INFO Init timings - ncclCommInitRankConfig: rank 0 nranks 4 total 0.11 (kernels 0.07, alloc 0.00, bootstrap 0.02, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:34340:34437 [1] NCCL INFO Init timings - ncclCommInitRankConfig: rank 1 nranks 4 total 0.10 (kernels 0.07, alloc 0.00, bootstrap 0.01, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:34342:34438 [3] NCCL INFO Init timings - ncclCommInitRankConfig: rank 3 nranks 4 total 0.10 (kernels 0.07, alloc 0.00, bootstrap 0.01, allgathers 0.00, topo 0.02, graphs 0.00, connections 0.00, rest 0.00)
alex-System-Product-Name:34339:34451 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
alex-System-Product-Name:34339:34451 [0] NCCL INFO Channel 03 : 0[0] -> 1[1] via SHM/direct/direct
alex-System-Product-Name:34341:34454 [2] NCCL INFO Channel 00 : 2[2] -> 3[3] via SHM/direct/direct
alex-System-Product-Name:34341:34454 [2] NCCL INFO Channel 02 : 2[2] -> 3[3] via SHM/direct/direct
alex-System-Product-Name:34339:34451 [0] NCCL INFO Channel 00/0 : 0[0] -> 2[2] via P2P/CUMEM
alex-System-Product-Name:34340:34452 [1] NCCL INFO Channel 01/0 : 1[1] -> 3[3] via P2P/CUMEM
alex-System-Product-Name:34339:34451 [0] NCCL INFO Channel 02/0 : 0[0] -> 2[2] via P2P/CUMEM
alex-System-Product-Name:34340:34452 [1] NCCL INFO Channel 03/0 : 1[1] -> 3[3] via P2P/CUMEM
alex-System-Product-Name:34341:34454 [2] NCCL INFO Channel 01/0 : 2[2] -> 0[0] via P2P/CUMEM
alex-System-Product-Name:34342:34453 [3] NCCL INFO Channel 00/0 : 3[3] -> 1[1] via P2P/CUMEM
alex-System-Product-Name:34341:34454 [2] NCCL INFO Channel 03/0 : 2[2] -> 0[0] via P2P/CUMEM
alex-System-Product-Name:34342:34453 [3] NCCL INFO Channel 02/0 : 3[3] -> 1[1] via P2P/CUMEM
alex-System-Product-Name:34342:34453 [3] NCCL INFO Channel 01 : 3[3] -> 2[2] via SHM/direct/direct
alex-System-Product-Name:34340:34452 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
alex-System-Product-Name:34342:34453 [3] NCCL INFO Channel 03 : 3[3] -> 2[2] via SHM/direct/direct
alex-System-Product-Name:34340:34452 [1] NCCL INFO Channel 02 : 1[1] -> 0[0] via SHM/direct/direct
alex-System-Product-Name:34339:34451 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:34340:34452 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:34341:34454 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
alex-System-Product-Name:34342:34453 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2025-06-25 02:45:35 [INFO    ] [Rank-34339] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 02:45:35 [INFO    ] [Rank-34339] root                : Rank 0: Sampled 100000 train rows from 4311800 total
2025-06-25 02:45:35 [INFO    ] [Rank-34339] root                : Rank 0: Sampled 20000 test rows from 1077950 total
2025-06-25 02:45:35 [INFO    ] [Rank-34340] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 02:45:35 [INFO    ] [Rank-34342] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 02:45:35 [INFO    ] [Rank-34340] root                : Rank 1: Sampled 100000 train rows from 4311800 total
2025-06-25 02:45:35 [INFO    ] [Rank-34340] root                : Rank 1: Sampled 20000 test rows from 1077950 total
2025-06-25 02:45:35 [INFO    ] [Rank-34340] numba.cuda.cudadrv.driver: init
2025-06-25 02:45:35 [INFO    ] [Rank-34342] root                : Rank 3: Sampled 100000 train rows from 4311800 total
2025-06-25 02:45:35 [INFO    ] [Rank-34342] root                : Rank 3: Sampled 20000 test rows from 1077950 total
2025-06-25 02:45:35 [INFO    ] [Rank-34342] numba.cuda.cudadrv.driver: init
2025-06-25 02:45:35 [INFO    ] [Rank-34341] root                : Total data: 4311800 train, 1077950 test rows
2025-06-25 02:45:35 [INFO    ] [Rank-34341] root                : Rank 2: Sampled 100000 train rows from 4311800 total
2025-06-25 02:45:35 [INFO    ] [Rank-34341] root                : Rank 2: Sampled 20000 test rows from 1077950 total
2025-06-25 02:45:35 [INFO    ] [Rank-34341] numba.cuda.cudadrv.driver: init
2025-06-25 02:45:37 [INFO    ] [Rank-34339] email_notifications : Email notifications configured for ali.aloraibi@outlook.com
2025-06-25 02:45:37 [INFO    ] [Rank-34339] email_notifications : Notifications will be sent every 6 hours
2025-06-25 02:45:37 [INFO    ] [Rank-34339] email_notifications : No training metrics available for progress update
2025-06-25 02:45:37 [INFO    ] [Rank-34339] email_notifications : Training monitoring started
2025-06-25 02:45:37 [INFO    ] [Rank-34339] root                : Email notifications enabled - reports every 6 hours
2025-06-25 02:45:37 [INFO    ] [Rank-34339] adaptive_trainer    : Removed old TensorBoard run: ./runs/ga_experiment
2025-06-25 02:45:37 [INFO    ] [Rank-34339] adaptive_trainer    : Starting adaptive training
2025-06-25 02:45:37 [INFO    ] [Rank-34339] adaptive_trainer    : 
=== Adaptive Training Iteration 1/20 ===
2025-06-25 02:45:37 [INFO    ] [Rank-34340] root                : Non-rank 0 process waiting for adaptive training to complete
2025-06-25 02:45:37 [INFO    ] [Rank-34342] root                : Non-rank 0 process waiting for adaptive training to complete
2025-06-25 02:45:37 [INFO    ] [Rank-34341] root                : Non-rank 0 process waiting for adaptive training to complete
2025-06-25 02:45:44 [INFO    ] [Rank-34339] adaptive_trainer    : Evaluation results: 19519 profits, total=13674170188873.9297
2025-06-25 02:45:44 [INFO    ] [Rank-34339] adaptive_trainer    : Metrics: CAGR=166.4597, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:45:44 [INFO    ] [Rank-34339] adaptive_trainer    : Current performance: 0.6894 (best: 0.6894)
2025-06-25 02:45:44 [INFO    ] [Rank-34339] adaptive_trainer    : Stagnation: 0, Poor performance: 0
2025-06-25 02:45:44 [INFO    ] [Rank-34339] adaptive_trainer    : Method: GA, Entropy: 1.0986
2025-06-25 02:45:44 [INFO    ] [Rank-34339] adaptive_trainer    : Switching to PPO due to: good_performance_refinement, ga_solution_refinement
2025-06-25 02:45:44 [INFO    ] [Rank-34339] adaptive_trainer    : Switching from GA to PPO
2025-06-25 02:45:44 [INFO    ] [Rank-34339] adaptive_trainer    : Starting PPO phase: 150 updates
2025-06-25 02:45:44 [INFO    ] [Rank-34339] policy_gradient_methods: No model file at models/ppo_models/adaptive_ppo_model.pth, starting from scratch
[rank0]:I0625 02:45:44.377000 34339 site-packages/torch/distributed/nn/jit/instantiator.py:24] Created a temporary directory at /tmp/tmptgwm7q3g
[rank0]:I0625 02:45:44.377000 34339 site-packages/torch/distributed/nn/jit/instantiator.py:75] Writing /tmp/tmptgwm7q3g/_remote_module_non_scriptable.py
Removed old TensorBoard run: ./runs/ppo_rank_0
2025-06-25 02:45:49 [INFO    ] [Rank-34339] adaptive_trainer    : Evaluation results: 13792 profits, total=6929852499315.8955
2025-06-25 02:45:49 [INFO    ] [Rank-34339] adaptive_trainer    : Metrics: CAGR=157.4996, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:46:46 [INFO    ] [Rank-34339] adaptive_trainer    : Evaluation results: 9406 profits, total=2983529364147.9429                                                                                               
2025-06-25 02:46:46 [INFO    ] [Rank-34339] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:46:46 [INFO    ] [Rank-34339] adaptive_trainer    : PPO Update 50: Performance=0.7900, Entropy=1.0986
2025-06-25 02:47:42 [INFO    ] [Rank-34339] adaptive_trainer    : Evaluation results: 19391 profits, total=13566398755014.8711                                                                                             
2025-06-25 02:47:42 [INFO    ] [Rank-34339] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:47:42 [INFO    ] [Rank-34339] adaptive_trainer    : PPO Update 100: Performance=0.7900, Entropy=1.0986
2025-06-25 02:48:28 [INFO    ] [Rank-34339] adaptive_trainer    : Evaluation results: 5775 profits, total=1192558179817.7891                                                                                               
2025-06-25 02:48:28 [INFO    ] [Rank-34339] adaptive_trainer    : Metrics: CAGR=200.0000, Sharpe=4.0000, MDD=5.0000
2025-06-25 02:48:28 [INFO    ] [Rank-34339] adaptive_trainer    : PPO Update 150: Performance=0.7900, Entropy=1.0986
2025-06-25 02:48:28 [INFO    ] [Rank-34339] policy_gradient_methods: Saved model to models/ppo_models/adaptive_ppo_model.pth at 2025-06-25 02:48:28.964228
2025-06-25 02:48:31 [INFO    ] [Rank-34339] adaptive_trainer    : Evaluation results: 7599 profits, total=4223556634369.4858
2025-06-25 02:48:31 [ERROR   ] [Rank-34339] adaptive_trainer    : Error during policy evaluation: 'PPOTrainer' object has no attribute 'update_trading_metrics'
2025-06-25 02:48:31 [ERROR   ] [Rank-34339] adaptive_trainer    : Traceback: Traceback (most recent call last):
  File "/mnt/windows/GeneticTrading/adaptive_trainer.py", line 229, in evaluate_current_policy
    self.ppo_trainer.update_trading_metrics(
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'PPOTrainer' object has no attribute 'update_trading_metrics'. Did you mean: 'get_training_metrics'?

2025-06-25 02:48:31 [INFO    ] [Rank-34339] adaptive_trainer    : PPO phase completed with performance: 0.0000
2025-06-25 02:48:31 [INFO    ] [Rank-34339] adaptive_trainer    : 
=== Adaptive Training Iteration 2/20 ===
2025-06-25 02:48:32 [INFO    ] [Rank-34339] adaptive_trainer    : Evaluation results: 3611 profits, total=974409420107.0947
2025-06-25 02:48:32 [ERROR   ] [Rank-34339] adaptive_trainer    : Error during policy evaluation: 'PPOTrainer' object has no attribute 'update_trading_metrics'
2025-06-25 02:48:32 [ERROR   ] [Rank-34339] adaptive_trainer    : Traceback: Traceback (most recent call last):
  File "/mnt/windows/GeneticTrading/adaptive_trainer.py", line 229, in evaluate_current_policy
    self.ppo_trainer.update_trading_metrics(
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'PPOTrainer' object has no attribute 'update_trading_metrics'. Did you mean: 'get_training_metrics'?

2025-06-25 02:48:32 [INFO    ] [Rank-34339] adaptive_trainer    : Current performance: 0.0000 (best: 0.6894)
2025-06-25 02:48:32 [INFO    ] [Rank-34339] adaptive_trainer    : Stagnation: 1, Poor performance: 1
2025-06-25 02:48:32 [INFO    ] [Rank-34339] adaptive_trainer    : Method: PPO, Entropy: 0.0000
2025-06-25 02:48:32 [INFO    ] [Rank-34339] adaptive_trainer    : Switching to GA due to: low_diversity, exploration_phase
2025-06-25 02:48:32 [INFO    ] [Rank-34339] adaptive_trainer    : Switching from PPO to GA
2025-06-25 02:48:32 [INFO    ] [Rank-34339] adaptive_trainer    : Starting GA phase: 30 generations, population 30
[GA] No model file at models/ga_models/adaptive_ga_model.pth, starting from scratch                                     
